=== FILE: /Users/shiv/workspace/syncortext/NewERP/Module/Design/Masters/ItemMaster_Print.aspx.txt ===

﻿<%@ Page Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="ItemMaster_Print.aspx.cs" Inherits="Module_Design_Masters_ItemMaster_Print" Title="ERP" Theme="Default"  %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
    <link href="../../../Css/yui-datatable.css" rel="stylesheet" type="text/css" />
    <link href="../../../Css/StyleSheet.css" rel="stylesheet" type="text/css" />

    <script src="../../../Javascript/loadingNotifier.js" type="text/javascript"></script>
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="cp3" Runat="Server"> 
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="cp1" Runat="Server">
</asp:Content>
<asp:Content ID="Content4" ContentPlaceHolderID="cp2" Runat="Server">
</asp:Content>
<asp:Content ID="Content5" ContentPlaceHolderID="MainContent" Runat="Server">
</asp:Content>
<asp:Content ID="Content6" ContentPlaceHolderID="ContentPlaceHolder2" Runat="Server">
</asp:Content>
<asp:Content ID="Content7" ContentPlaceHolderID="ContentPlaceHolder3" Runat="Server">
  
    <table width="100%" cellpadding="0" cellspacing="0">
               <tr>
                        <td   align="left" valign="middle"  scope="col" class="fontcsswhite" 
                            style="background:url(../../../images/hdbg.JPG)" height="21">
                    &nbsp;<b>Item Master- Print&nbsp;</b></td>
                    </tr>
  
  
                    <%--<tr>
            <td  height="25" valign="middle" >
            
                <asp:DropDownList ID="DrpCategory" runat="server" 
                    AutoPostBack="True" 
                    
                    CssClass="box3">
                    
                </asp:DropDownList> 
                
                 &nbsp;&nbsp;
                
        <asp:Button ID="btnSearch" runat="server" 
            Text="  View  " CssClass="redbox" onclick="btnSearch_Click"  />
                        &nbsp;</td>
             </tr>--%>
             
              <tr>
            <td class="fontcsswhite" height="25" valign="middle" >
            
             &nbsp;
            
            <asp:DropDownList ID="DrpType" runat="server" AutoPostBack="True" 
                    Height="21px" Width="100px" CssClass="box3" 
                    onselectedindexchanged="DrpType_SelectedIndexChanged">
                     <asp:ListItem>Select</asp:ListItem>
                     <asp:ListItem Value="Category">Category</asp:ListItem>
                     <asp:ListItem Value="WOItems">WO Items</asp:ListItem>                    
                </asp:DropDownList>
               <%-- &nbsp;<asp:RequiredFieldValidator ID="ReqDrpType" runat="server" 
                    ControlToValidate="DrpType" ErrorMessage="*" InitialValue="Select" 
                    ValidationGroup="A"></asp:RequiredFieldValidator>--%>
                <asp:DropDownList ID="DrpCategory1" runat="server" Width="200px" 
                    AutoPostBack="True" 
                    onselectedindexchanged="DrpCategory1_SelectedIndexChanged" Height="21px" 
                    CssClass="box3">
                    
                </asp:DropDownList> 
                
                 <asp:DropDownList ID="DrpSearchCode" runat="server" Width="200px" 
                    CssClass="box3" AutoPostBack="True" 
                    onselectedindexchanged="DrpSearchCode_SelectedIndexChanged">
                     <asp:ListItem Value="Select">Select</asp:ListItem>
                     <asp:ListItem Value="tblDG_Item_Master.ItemCode">Item Code</asp:ListItem>
                     <asp:ListItem Value="tblDG_Item_Master.ManfDesc">Description</asp:ListItem>                    
                     <asp:ListItem Value="tblDG_Item_Master.Location">Location</asp:ListItem>
                </asp:DropDownList>
                
                <asp:DropDownList ID="DropDownList3" runat="server" 
                                style="margin-bottom: 0px" Width="155px" 
                    onselectedindexchanged="DropDownList3_SelectedIndexChanged" 
                    AutoPostBack="True" CssClass="box3">
                            </asp:DropDownList>

            
                <asp:TextBox ID="txtSearchItemCode" runat="server" Width="207px" 
                    CssClass="box3"></asp:TextBox>
                
                &nbsp;<asp:Button ID="btnSearch" runat="server" 
            Text="View" CssClass="redbox" onclick="btnSearch_Click" ValidationGroup="A"  />
            <asp:Label ID="lblMessage" runat="server" ForeColor="Red"></asp:Label>
                        </td>
             </tr>
  
  
 <tr>
 
 
 <td>
                    <iframe id="Iframe1"  runat ="server" width="100%" height="440px" 
                        frameborder="0" scrolling="auto" ></iframe>
 
             </td>   
             </tr>
         </table>        
                
</asp:Content>
<asp:Content ID="Content8" ContentPlaceHolderID="ContentPlaceHolder4" Runat="Server">
</asp:Content>



=== FILE: /Users/shiv/workspace/syncortext/NewERP/Module/Design/Masters/ItemMaster_Print.aspx.cs ===

﻿using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Data.SqlClient;

public partial class Module_Design_Masters_ItemMaster_Print : System.Web.UI.Page
{
    clsFunctions fun = new clsFunctions();
    DataSet DS = new DataSet();
    DataSet DS2 = new DataSet();
    int CompId = 0;
    protected void Page_Load(object sender, EventArgs e)
    {

        lblMessage.Text = "";
        try
        {
           
            CompId = Convert.ToInt32(Session["compid"]);            
            if (!IsPostBack)
            {
                DrpCategory1.Items.Clear();
                DrpCategory1.Items.Insert(0, "Select");
                DropDownList3.Visible = false;
                DrpCategory1.Visible = false;
                DrpSearchCode.Visible = false;
                txtSearchItemCode.Visible = false;

            }

        }
        catch (Exception ex)
        {
        }
        finally
        {
        }
    }


    protected void DrpType_SelectedIndexChanged(object sender, EventArgs e)
    {

        try
        {
        switch (DrpType.SelectedValue)
        {
            case "Category":
                {
                    DrpSearchCode.Visible = true;
                    DropDownList3.Visible = true;
                    txtSearchItemCode.Visible = true;
                    txtSearchItemCode.Text = "";
                    DrpCategory1.Visible = true;

                    string connStr = fun.Connection();
                    SqlConnection con = new SqlConnection(connStr);

                    DataSet DS = new DataSet();
                    string StrCat = fun.select("CId,'['+Symbol+'] - '+CName as Category", "tblDG_Category_Master", "CompId='" + CompId + "'");
                    SqlCommand Cmd = new SqlCommand(StrCat, con);
                    SqlDataAdapter DA = new SqlDataAdapter(Cmd);
                    DA.Fill(DS, "tblDG_Category_Master");
                    DrpCategory1.DataSource = DS.Tables["tblDG_Category_Master"];
                    DrpCategory1.DataTextField = "Category";
                    DrpCategory1.DataValueField = "CId";
                    DrpCategory1.DataBind();
                    DrpCategory1.Items.Insert(0, "Select");
                    DrpCategory1.ClearSelection();

                    //string loc = fun.select1("Id,LocationLabel+'-'+tblDG_Location_Master.LocationNo As Location ", "tblDG_Location_Master");
                    //SqlCommand cmdloc = new SqlCommand(loc, con);
                    //SqlDataAdapter daloc = new SqlDataAdapter(cmdloc);
                    //DataSet dsloc = new DataSet();
                    //daloc.Fill(dsloc, "tblDG_Location_Master");
                    //DropDownList3.DataSource = dsloc.Tables["tblDG_Location_Master"];
                    //DropDownList3.DataTextField = "Location";
                    //DropDownList3.DataValueField = "Id";
                    //DropDownList3.DataBind();
                    //DropDownList3.Items.Insert(0, "Select");
                    fun.drpLocat(DropDownList3);

                    if (DrpSearchCode.SelectedItem.Text == "Location")
                    {
                        DropDownList3.Visible = true;
                        txtSearchItemCode.Visible = false;
                        txtSearchItemCode.Text = "";
                    }
                    else
                    {
                        DropDownList3.Visible = false;
                        txtSearchItemCode.Visible = true;
                        txtSearchItemCode.Text = "";
                    }

                }
                break;

            case "WOItems":
                {
                    txtSearchItemCode.Visible = true;
                    txtSearchItemCode.Text = "";


                    DrpSearchCode.Visible = true;
                    DrpCategory1.Visible = false;
                    DrpCategory1.Items.Clear();
                    DrpCategory1.Items.Insert(0, "Select");

                    DropDownList3.Visible = false;
                    DropDownList3.Items.Clear();
                    DropDownList3.Items.Insert(0, "Select");
                }
                break;

            case "Select":
                {
                    Page.Response.Redirect(Page.Request.Url.ToString(), true);
                }
                break;
        }
        }
        catch (Exception ex)
        {
        }
        finally
        {
        }
    }

    protected void DrpCategory1_SelectedIndexChanged(object sender, EventArgs e)
    {       

    }

    protected void DrpSearchCode_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (DrpSearchCode.SelectedItem.Text == "Location")
        {

            DropDownList3.Visible = true;
            txtSearchItemCode.Visible = false;
           

        }
        else
        {
            DropDownList3.Visible = false;
            txtSearchItemCode.Visible = true;
            
        }
    }

    protected void DropDownList3_SelectedIndexChanged(object sender, EventArgs e)
    {
       
    }
    protected void btnSearch_Click(object sender, EventArgs e)
    {
        try
        {
            
             string sd = DrpCategory1.SelectedValue;
             string c = DrpSearchCode.SelectedValue;
             string d = txtSearchItemCode.Text;
             if (DrpType.SelectedValue!="Select")
            {            
               string getRandomKey = fun.GetRandomAlphaNumeric();
               Iframe1.Attributes.Add("src", "ItemMaster_Print_Details.aspx?category=" + sd + "&SearchCode=" + c + "&SearchItemCode=" + d + "&DrpTypeVal=" + DrpType.SelectedValue + "&DrplocationVal=" + DropDownList3.SelectedValue + "&Key=" + getRandomKey + "");
            
            }
             else
             {
                 string myStringVariable = string.Empty;
                 myStringVariable = "Select Category or WO Items.";
                 ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
             }
           
        }
        catch(Exception ex)
        {
        }
       
    }

   

   



}
