=== FILE: /Users/shiv/workspace/syncortext/NewERP/Module/Accounts/Transactions/Advice.aspx.txt ===

ï»¿<%@ Page Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="Advice.aspx.cs" Inherits="Module_Accounts_Transactions_Advice" Title="ERP" Culture="en-GB" Theme="Default" %>


<%@ Register assembly="AjaxControlToolkit" namespace="AjaxControlToolkit" tagprefix="cc1" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
<link href="../../../Css/StyleSheet.css" rel="stylesheet" type="text/css" />
    <link href="../../../Css/yui-datatable.css" rel="stylesheet" type="text/css" />
    <link href="../../../Css/styles.css" rel="stylesheet" type="text/css" />
    <script src="../../../Javascript/loadingNotifier.js" type="text/javascript"></script>
    <script src="../../../Javascript/PopUpMsg.js" type="text/javascript"></script>
    
      
    
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="cp3" Runat="Server">
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="cp1" Runat="Server">
</asp:Content>
<asp:Content ID="Content4" ContentPlaceHolderID="cp2" Runat="Server">
</asp:Content>
<asp:Content ID="Content5" ContentPlaceHolderID="MainContent" Runat="Server">
</asp:Content>
<asp:Content ID="Content6" ContentPlaceHolderID="ContentPlaceHolder2" Runat="Server">
</asp:Content>
<asp:Content ID="Content7" ContentPlaceHolderID="ContentPlaceHolder3" Runat="Server">



<table  width="100%">
        <tr>
            <td align="left" valign="middle" style="background:url(../../../images/hdbg.JPG)" height="21" class="fontcsswhite"><b>&nbsp;Advice</b></td>
        </tr>
        <tr>
            <td>
                <cc1:TabContainer ID="TabContainer1" runat="server" ActiveTabIndex="0" 
                    AutoPostBack="true"
                    Width="100%" >
                    <cc1:TabPanel runat="server" HeaderText="Payment" ID="Add">  
                    
                    <HeaderTemplate>Payment
                    
                    
                    </HeaderTemplate>
                    

<ContentTemplate><asp:Panel ID="Panel1" ScrollBars="Auto" runat="server" ><cc1:TabContainer 
        ID="TabContainer2" runat="server" ActiveTabIndex="0" 
                    AutoPostBack="True"
                    Width="100%" Height="390px" ScrollBars="Auto" ><cc1:TabPanel runat="server" HeaderText="Advance" ID="TabPanel11"><HeaderTemplate>Advance</HeaderTemplate><ContentTemplate><asp:Panel ID="Panel3" ScrollBars="Auto" runat="server" ><table cellpadding="0" cellspacing="0" width="100%"><tr><td >Payment Against : </td><td >Advance</td><td height="25" valign="middle">Pay To : </td><td 
            align="right" height="25" valign="middle"><asp:DropDownList ID="drptype" 
            runat="server" AutoPostBack="True" 
            onselectedindexchanged="drptype_SelectedIndexChanged1"><asp:ListItem Value="0">Select</asp:ListItem><asp:ListItem 
                Value="1">Employee</asp:ListItem><asp:ListItem Value="2">Customer</asp:ListItem><asp:ListItem 
                Value="3">Supplier</asp:ListItem></asp:DropDownList></td><td height="25" 
                    valign="middle" width="1%">&nbsp;</td><td height="25" valign="middle"  ><asp:TextBox ID="TextBox1" runat="server" CssClass="box3" Width="70%"></asp:TextBox><cc1:AutoCompleteExtender ID="Txt_AutoCompleteExtender" runat="server" 
                        CompletionInterval="100"
                         CompletionListCssClass="almt" 
                        CompletionListHighlightedItemCssClass="bgtext"
                         CompletionListItemCssClass="bg" 
                        CompletionSetCount="2"
                         DelimiterCharacters="" Enabled="True" 
                        FirstRowSelected="True" 
                        MinimumPrefixLength="1" ServiceMethod="sql3" 
                        ServicePath=""
                         ShowOnlyCurrentWordInCompletionListItem="True" 
                        TargetControlID="TextBox1" UseContextKey="True"></cc1:AutoCompleteExtender><asp:RequiredFieldValidator ID="ReqEmpEdit" runat="server" 
                        ControlToValidate="TextBox1" ErrorMessage="*" ValidationGroup="B"></asp:RequiredFieldValidator></td><td>&#160;</td></tr><tr><td >Cheque No./ D.D.No.:</td><td ><asp:TextBox 
            ID="txtDDNo" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator 
            ID="ReqDDNo" runat="server" ControlToValidate="txtDDNo" ErrorMessage="*" 
            ValidationGroup="B"></asp:RequiredFieldValidator></td><td height="25" 
            valign="middle" colspan="2">Cheque Date :</td><td height="25" valign="middle">&nbsp;</td><td height="25" valign="middle" ><asp:TextBox ID="textChequeDate" runat="server" CssClass="box3" Width="70%"></asp:TextBox><cc1:CalendarExtender ID="textDelDate_CalendarExtender" runat="server" 
                            Enabled="True" Format="dd-MM-yyyy" TargetControlID="textChequeDate"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="ReqDelDate" runat="server" 
                            ControlToValidate="textChequeDate" ErrorMessage="*" ValidationGroup="B"></asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegDelverylDate" runat="server" 
                            ControlToValidate="textChequeDate" ErrorMessage="*" 
                            ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$" 
                            ValidationGroup="B"></asp:RegularExpressionValidator></td><td>&#160;</td></tr><tr><td >Drawn On</td><td ><asp:DropDownList 
            ID="DropDownList1" runat="server" CssClass="box3" DataSourceID="SqlDataSource1" 
            DataTextField="Name" DataValueField="Id"></asp:DropDownList></td><td 
            colspan="2">Payable At :</td><td>&nbsp;</td><td ><asp:TextBox ID="txtPayAt" runat="server" CssClass="box3" Width="70%"></asp:TextBox><asp:RequiredFieldValidator ID="ReqPayableAt" runat="server" 
                        ControlToValidate="txtPayAt" ErrorMessage="*" ValidationGroup="B"></asp:RequiredFieldValidator></td><td></td></tr><tr><td >&#160;&nbsp;</td></tr></table></asp:Panel><table width="100%"><tr><td><asp:Panel ID="Panel8" runat="server" 
                Height="283px" ScrollBars="Auto"><asp:GridView ID="GridView1"  
                runat="server"
                ShowFooter="True" 
                AutoGenerateColumns="False" 
                DataKeyNames="Id"
              OnRowCommand="GridView1_RowCommand" CssClass="yui-datatable-theme" Width="100%" 
                    onrowdatabound="GridView1_RowDataBound" 
                    onrowupdating="GridView1_RowUpdating" AllowPaging="True" 
                    DataSourceID="SqlDataSource2" PageSize="14"><Columns><asp:TemplateField ShowHeader="False"><ItemTemplate><asp:LinkButton ID="LinkButton4" OnClientClick="return confirmationUpdate();" runat="server" CausesValidation="False" 
                                   CommandName="Edit" Text="Edit"> </asp:LinkButton></ItemTemplate><EditItemTemplate><asp:LinkButton ID="LinkButton1" runat="server" CausesValidation="True" 
                                   CommandName="Update" Text="Update"> </asp:LinkButton>&nbsp;<asp:LinkButton ID="LinkButton2" runat="server" CausesValidation="False" 
                                   CommandName="Cancel" Text="Cancel"></asp:LinkButton>
                </EditItemTemplate><ItemStyle HorizontalAlign="Center" Width="6%" /></asp:TemplateField><asp:TemplateField ShowHeader="False"><ItemTemplate><asp:LinkButton ID="LinkButton3" runat="server" OnClientClick="return confirmationDelete();" CausesValidation="False" 
                                   CommandName="Delete" Text="Delete"> </asp:LinkButton></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="4%" /></asp:TemplateField><asp:TemplateField HeaderText="SN" SortExpression="Id"><ItemTemplate><%#Container.DataItemIndex+1  %></ItemTemplate><FooterTemplate><asp:Button ID="btnInsert" runat="server" Text="Insert" ValidationGroup="abc" 
                        OnClientClick=" return confirmationAdd()" CommandName="Add" CssClass="redbox" />
                </FooterTemplate><ItemStyle HorizontalAlign="Right" Width="2%" /></asp:TemplateField><asp:TemplateField HeaderText="Proforma Inv No  "><ItemTemplate><asp:Label ID="lblProFormaInvNo" runat="server" Text='<%#Eval("ProformaInvNo") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtProforInvNo" Width="97%" runat="server" CssClass="box3"  ValidationGroup="Shree" Text='<%#Bind("ProformaInvNo") %>'> </asp:TextBox><asp:RequiredFieldValidator ID="ReqProE" ValidationGroup="Shree" ControlToValidate="txtProforInvNo" 
                            runat="server" ErrorMessage="*"> </asp:RequiredFieldValidator>
                </EditItemTemplate><FooterTemplate><asp:TextBox ID="txtProforInvNoFoot" Width="90%" CssClass="box3" ValidationGroup="abc" runat="server"> </asp:TextBox><asp:RequiredFieldValidator ID="ReqProF" runat="server" ValidationGroup="abc" ControlToValidate="txtProforInvNoFoot" 
                         ErrorMessage="*"></asp:RequiredFieldValidator></FooterTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Left" Width="8%" /></asp:TemplateField><asp:TemplateField HeaderText="Date"><ItemTemplate><asp:Label ID="lblDate" runat="server" Text='<%#Eval("InvDate") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="textDate" runat="server" Text='<%#Eval("InvDate") %>' CssClass="box3"> </asp:TextBox><cc1:CalendarExtender ID="textDate_CalendarExtender" runat="server" 
                                            Enabled="True" Format="dd-MM-yyyy" TargetControlID="textDate"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="ReqDate" runat="server" 
                                            ControlToValidate="textDate" ErrorMessage="*" ValidationGroup="Shree"> </asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegDate" ValidationGroup="Shree" runat="server" 
                                            ControlToValidate="textDate" ErrorMessage="*" 
                                            ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$"> </asp:RegularExpressionValidator>
                </EditItemTemplate><FooterTemplate><asp:TextBox ID="textDateF" runat="server" Width="80%" CssClass="box3"> </asp:TextBox><cc1:CalendarExtender ID="textDateF_CalendarExtender" runat="server" 
                                            Enabled="True" Format="dd-MM-yyyy" TargetControlID="textDateF"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="ReqDateF" runat="server" 
                                            ControlToValidate="textDateF" ErrorMessage="*" ValidationGroup="abc"> </asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegDateF" ValidationGroup="abc" runat="server" 
                                            ControlToValidate="textDateF" ErrorMessage="*" 
                                            ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$"> </asp:RegularExpressionValidator></FooterTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Left" Width="7%" /></asp:TemplateField><asp:TemplateField HeaderText="PO No"><ItemTemplate><asp:Label ID="lblPoNo" runat="server" Text='<%#Eval("PONo") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtPoNo" Width="97%" runat="server" CssClass="box3"  ValidationGroup="Shree" Text='<%#Bind("PONo") %>'> </asp:TextBox><asp:RequiredFieldValidator ID="ReqPoE" ValidationGroup="Shree" ControlToValidate="txtPoNo" 
                            runat="server" ErrorMessage="*"> </asp:RequiredFieldValidator>
                </EditItemTemplate><FooterTemplate><asp:TextBox ID="txtPoNoFoot" CssClass="box3" Width="86%"   ValidationGroup="abc" runat="server"> </asp:TextBox><asp:RequiredFieldValidator ID="ReqPoF" runat="server" ValidationGroup="abc" ControlToValidate="txtPoNoFoot" 
                         ErrorMessage="*"></asp:RequiredFieldValidator></FooterTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Center" Width="6%" /></asp:TemplateField><asp:TemplateField HeaderText="Particulars"><ItemTemplate><asp:Label ID="lblParticulars" runat="server" Text='<%#Eval("Particular") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtParticulars" Width="99%" runat="server" CssClass="box3"  ValidationGroup="Shree" Text='<%#Bind("Particular") %>'> </asp:TextBox>
                </EditItemTemplate><FooterTemplate><asp:TextBox ID="txtParticularsFoot" CssClass="box3"   Width="99%" ValidationGroup="abc" runat="server"> </asp:TextBox></FooterTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Left" Width="25%" /></asp:TemplateField><asp:TemplateField HeaderText="Amount"><ItemTemplate><asp:Label ID="lblAmount" runat="server" Text='<%#Eval("Amount") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtAmount" Width="97%" runat="server" CssClass="box3"  ValidationGroup="Shree" Text='<%#Bind("Amount") %>'> </asp:TextBox><asp:RequiredFieldValidator ID="ReqAmountE" ValidationGroup="Shree" ControlToValidate="txtAmount" 
                            runat="server" ErrorMessage="*"> </asp:RequiredFieldValidator>
                </EditItemTemplate><FooterTemplate><asp:TextBox ID="txtAmountFoot" Width="85%" CssClass="box3"  ValidationGroup="abc" runat="server"> </asp:TextBox><asp:RequiredFieldValidator ID="ReqAmountF" runat="server" ValidationGroup="abc" ControlToValidate="txtAmountFoot" 
                         ErrorMessage="*"></asp:RequiredFieldValidator></FooterTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Right" Width="6%" /></asp:TemplateField></Columns><EmptyDataTemplate><table border="1pt" style="border-color:GrayText" width="100%"><tr><th>Proforma Invoice No </th><th>Date </th><th>PONo </th><th>Amount </th><th>Particulars </th><th></th></tr><tr><td><asp:TextBox ID="txtProInv" runat="server" CssClass="box3" 
                                         ValidationGroup="pqr" Width="92%"> </asp:TextBox><asp:RequiredFieldValidator ID="ReqProInv" runat="server" 
                                         ControlToValidate="txtProInv" ErrorMessage="*" ValidationGroup="pqr"></asp:RequiredFieldValidator></td><td><asp:TextBox ID="txtDate1" runat="server" CssClass="box3" ValidationGroup="pqr" 
                                         Width="88%"> </asp:TextBox><cc1:CalendarExtender ID="text_CalendarExtender" runat="server" Enabled="True" 
                                         Format="dd-MM-yyyy" TargetControlID="txtDate1"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="ReqDate1" runat="server" 
                                         ControlToValidate="txtDate1" ErrorMessage="*" ValidationGroup="pqr"> </asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegDate1" runat="server" 
                                         ControlToValidate="txtDate1" ErrorMessage="*" 
                                         ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$" 
                                         ValidationGroup="pqr"> </asp:RegularExpressionValidator></td><td><asp:TextBox ID="txtPo" runat="server" CssClass="box3" ValidationGroup="pqr" 
                                         Width="92%"> </asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator2" runat="server" 
                                         ControlToValidate="txtPo" ErrorMessage="*" ValidationGroup="pqr"></asp:RequiredFieldValidator></td><td><asp:TextBox ID="txtAmt" runat="server" CssClass="box3" ValidationGroup="pqr" 
                                         Width="92%"> </asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator3" runat="server" 
                                         ControlToValidate="txtAmt" ErrorMessage="*" ValidationGroup="pqr"></asp:RequiredFieldValidator></td><td><asp:TextBox ID="txtparticul" runat="server" CssClass="box3" 
                                         ValidationGroup="pqr" Width="99%"> </asp:TextBox></td><td><asp:Button ID="btnInsert" runat="server" CommandName="Add1" CssClass="redbox" 
                                         OnClientClick=" return confirmationAdd()" Text="Insert" ValidationGroup="pqr" /></td></tr></table></EmptyDataTemplate><FooterStyle Wrap="True"></FooterStyle><PagerSettings PageButtonCount="40" /></asp:GridView></asp:Panel></td></tr><tr><td align="center" style="height:25px"><asp:Button 
                                    ID="btnProceed" runat="server" CssClass="redbox" OnClick="btnProceed_Click" 
                                    onclientclick="return confirmationAdd();" Text="Proceed" ValidationGroup="B" /></td></tr></table></ContentTemplate></cc1:TabPanel><cc1:TabPanel ID="TabPanel21" runat="server" HeaderText="Creditors"><HeaderTemplate>Creditors</HeaderTemplate><ContentTemplate><asp:Panel ID="Panel4" ScrollBars="Auto" runat="server" ><table cellpadding="0" cellspacing="0" width="100%"><tr><td >Payment Against : </td><td >Creditors</td><td height="25" valign="middle">Pay To :</td><td height="25" valign="middle"><asp:TextBox ID="txtPayTo_Credit" runat="server" CssClass="box3" Width="70%"></asp:TextBox><cc1:AutoCompleteExtender ID="AutoCompleteExtender3" runat="server" 
                                            CompletionInterval="100" CompletionListCssClass="almt" 
                                            CompletionListHighlightedItemCssClass="bgtext" CompletionListItemCssClass="bg" 
                                            CompletionSetCount="2" DelimiterCharacters="" Enabled="True" 
                                            FirstRowSelected="True" MinimumPrefixLength="1" 
                                            ServiceMethod="Sql" ServicePath="" 
                                            ShowOnlyCurrentWordInCompletionListItem="True" TargetControlID="txtPayTo_Credit" 
                                            UseContextKey="True"></cc1:AutoCompleteExtender><asp:RequiredFieldValidator ID="RequiredFieldValidator12" runat="server" 
                                            ControlToValidate="txtPayTo_Credit" ErrorMessage="*" ValidationGroup="z1"></asp:RequiredFieldValidator></td><td  ><asp:Button ID="btnSearch" runat="server" CssClass="redbox" 
                                 onclick="btnSearch_Click" Text="Search" /><asp:Button ID="btnRefresh" runat="server" Visible="False" CssClass="redbox" Text="Refresh" 
                                 onclick="btnRefresh_Click" /></td></tr><tr><td >Cheque No./ D.D.No.: </td><td ><asp:TextBox ID="txtChequeNo_Credit" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator13" runat="server" 
                                            ControlToValidate="txtChequeNo_Credit" ErrorMessage="*" ValidationGroup="z1"></asp:RequiredFieldValidator></td><td height="25" valign="middle">Cheque Date : </td><td height="25" valign="middle"><asp:TextBox 
                                ID="txtChequeDate_Credit" runat="server" CssClass="box3" Width="70%"></asp:TextBox><cc1:CalendarExtender ID="CalendarExtender3" runat="server" 
                                            Enabled="True" Format="dd-MM-yyyy" TargetControlID="txtChequeDate_Credit"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="RequiredFieldValidator14" ValidationGroup="z1"  runat="server" 
                                            ControlToValidate="txtChequeDate_Credit" ErrorMessage="*"></asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegularExpressionValidator3" runat="server" 
                                            ControlToValidate="txtChequeDate_Credit" ErrorMessage="*"  ValidationGroup="z1" 
                                            ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$"></asp:RegularExpressionValidator></td><td >&#160;&nbsp;</td></tr><tr><td >Drawn On : </td><td ><asp:DropDownList ID="DropDownList4" runat="server" CssClass="box3" 
                                            DataSourceID="SqlDataSource6" DataTextField="Name" DataValueField="Id"></asp:DropDownList></td><td>Payable At : </td><td><asp:TextBox 
                                ID="txtPayAt_Credit" runat="server" CssClass="box3" Width="70%"></asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator15" runat="server" 
                                            ControlToValidate="txtPayAt_Credit" ErrorMessage="*" ValidationGroup="z1"></asp:RequiredFieldValidator></td><td ></td></tr><tr><td >&#160;&nbsp;</td></tr></table></asp:Panel><table width="100%"><tr><td><asp:Panel ID="Panel5" runat="server" 
                    Height="145px" ScrollBars="Auto"><asp:GridView ID="GridView4"  
                runat="server"  ShowFooter="True"
                AutoGenerateColumns="False" 
                DataKeyNames="Id"
               CssClass="yui-datatable-theme" Width="100%" onrowcommand="GridView4_RowCommand"><Columns><asp:TemplateField HeaderText="SN" SortExpression="Id"><ItemTemplate><%#Container.DataItemIndex+1  %></ItemTemplate><ItemStyle HorizontalAlign="Right" Width="2%" /></asp:TemplateField><asp:TemplateField><ItemTemplate><asp:CheckBox ID="ck" runat="server" /></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="2%" /></asp:TemplateField><asp:TemplateField HeaderText="Id" Visible="False"  ><ItemTemplate><asp:Label ID="lblId" runat="server" Text='<%#Eval("Id") %>'> </asp:Label></ItemTemplate><ItemStyle HorizontalAlign="Left" Width="3%" /></asp:TemplateField><asp:TemplateField HeaderText="PVEV No"><ItemTemplate><asp:Label ID="lblPVEVNO" runat="server" Text='<%#Eval("PVEVNo") %>'> </asp:Label></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="7%" /></asp:TemplateField><asp:TemplateField HeaderText="PONo"><ItemTemplate><asp:Label ID="lblPONo" runat="server" Text='<%#Eval("PONo") %>'> </asp:Label></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="5%" /></asp:TemplateField><asp:TemplateField HeaderText="Bill No"><ItemTemplate><asp:Label ID="lblBillNo" runat="server" Text='<%#Bind("BillNo") %>'> </asp:Label></ItemTemplate><ItemStyle 
            HorizontalAlign="Center" Width="4%" /></asp:TemplateField><asp:TemplateField HeaderText="Bill Date"><ItemTemplate><asp:Label ID="lblBillDate" runat="server" Text='<%#Eval("BillDate") %>'> </asp:Label></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="5%" /></asp:TemplateField><asp:TemplateField HeaderText="Against Bill"><ItemTemplate><asp:TextBox ID="txtBill_Against" Width="88%" runat="server" CssClass="box3"  > </asp:TextBox><asp:RequiredFieldValidator ID="ReqBillAgainst" ValidationGroup="temp"  ControlToValidate="txtBill_Against" 
                            runat="server" ErrorMessage="*"> </asp:RequiredFieldValidator></ItemTemplate><ItemStyle HorizontalAlign="Left" Width="6%" /></asp:TemplateField><asp:TemplateField HeaderText="Actual Amt"><ItemTemplate><asp:Label ID="lblActAmt" runat="server" Text='<%#Eval("ActAmt") %>'> </asp:Label></ItemTemplate><ItemStyle HorizontalAlign="Right" Width="7%" /></asp:TemplateField><asp:TemplateField HeaderText="Paid Amt"><ItemTemplate><asp:Label ID="lblpaidAmt" runat="server" Text='<%#Eval("PaidAmt") %>'> </asp:Label></ItemTemplate><ItemStyle HorizontalAlign="Right" Width="20%" /></asp:TemplateField><asp:TemplateField HeaderText="Bal Amt"><ItemTemplate><asp:Label ID="lblBalAmt" runat="server" Text='<%#Eval("BalAmt") %>'> </asp:Label></ItemTemplate><ItemStyle HorizontalAlign="Right" Width="7%" /></asp:TemplateField><asp:TemplateField HeaderText="Amount"><ItemTemplate><asp:TextBox ID="txtAmount" Width="79%" runat="server" CssClass="box3" > </asp:TextBox><asp:RequiredFieldValidator ID="Req16" ValidationGroup="temp"  ControlToValidate="txtAmount" 
                            runat="server" ErrorMessage="*"> </asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegularReqAmt" runat="server" 
                                    ControlToValidate="txtAmount" ErrorMessage="*" 
                                    ValidationExpression="^\d{1,15}(\.\d{0,3})?$" ValidationGroup="temp"></asp:RegularExpressionValidator></ItemTemplate><ItemStyle HorizontalAlign="Left" Width="7%" /></asp:TemplateField><asp:TemplateField HeaderText="Narration"><ItemTemplate><asp:TextBox ID="txtNarration" Width="99%" runat="server" CssClass="box3"> </asp:TextBox></ItemTemplate><FooterTemplate><asp:Button ID="btnAddTemp" ValidationGroup="temp"  CssClass="redbox" 
                            runat="server" Text="Add" CommandName="AddToTemp"/></FooterTemplate><FooterStyle HorizontalAlign="Right" /><ItemStyle HorizontalAlign="Center" Width="10%" /></asp:TemplateField></Columns><EmptyDataTemplate><table width="100%" class="fontcss"><tr><td align="center"><asp:Label ID="Label1" runat="server"  Text="No data to display !" Font-Size="Larger" ForeColor="maroon"> </asp:Label></td></tr></table></EmptyDataTemplate></asp:GridView><br /></asp:Panel></td></tr><tr><td style="height:10px;"></td></tr><tr><td><asp:Panel ID="Panel10" runat="server" Height="125px" ScrollBars="Auto"><asp:GridView ID="GridView5"  
                runat="server" 
                AutoGenerateColumns="False" 
                DataKeyNames="Id"
                CssClass="yui-datatable-theme" Width="100%"                     
                AllowPaging="True" 
                onpageindexchanging="GridView5_PageIndexChanging" 
                onrowcancelingedit="GridView5_RowCancelingEdit" 
                onrowdeleting="GridView5_RowDeleting" onrowediting="GridView5_RowEditing" 
                        PageSize="5"><Columns><asp:TemplateField ShowHeader="False"><ItemTemplate><asp:LinkButton ID="LinkButton3" runat="server" OnClientClick="return confirmationDelete();" CausesValidation="False" 
                                   CommandName="Delete" Text="Delete"> </asp:LinkButton></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="4%" /></asp:TemplateField><asp:TemplateField HeaderText="SN" SortExpression="Id"><ItemTemplate><%#Container.DataItemIndex+1  %></ItemTemplate><ItemStyle HorizontalAlign="Right" Width="2%" /></asp:TemplateField><asp:TemplateField Visible="False" ><ItemTemplate><asp:Label ID="lblId" runat="server" Text='<%#Eval("Id") %>'> </asp:Label></ItemTemplate><ItemStyle HorizontalAlign="Left" Width="8%" /></asp:TemplateField><asp:TemplateField HeaderText="PVEV No"  ><ItemTemplate><asp:Label ID="lblPvevNo" Text='<%#Eval("PVEVNo") %>' runat="server" > </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtPvEvE" Text='<%#Eval("PVEVNo") %>' runat="server"> </asp:TextBox></EditItemTemplate><ItemStyle HorizontalAlign="Center" Width="4%" /></asp:TemplateField><asp:TemplateField HeaderText="Bill Against"  ><ItemTemplate><asp:Label ID="lblBillAgainst" runat="server" Text='<%#Eval("BillAgainst") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtBillAgstE" Text='<%#Eval("BillAgainst") %>' runat="server"> </asp:TextBox></EditItemTemplate><ItemStyle HorizontalAlign="Left" Width="25%" /></asp:TemplateField><asp:TemplateField HeaderText="Bal Amt"  ><ItemTemplate><asp:Label ID="lblBalamt" runat="server" Text='<%#Eval("BalAmt") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:Label ID="lblBalamtE" runat="server" Text='<%#Eval("BalAmt") %>'> </asp:Label><asp:Label ID="lblActAmt" runat="server" Text='<%#Eval("ActAmt") %>'> </asp:Label></EditItemTemplate><ItemStyle HorizontalAlign="Right" Width="7%" /></asp:TemplateField><asp:TemplateField HeaderText="Amount"  ><ItemTemplate><asp:Label ID="lblamt" runat="server" Text='<%#Eval("Amount") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtAmountE" Text='<%#Eval("Amount") %>' runat="server"> </asp:TextBox></EditItemTemplate><ItemStyle HorizontalAlign="Right" Width="7%" /></asp:TemplateField></Columns><EmptyDataTemplate><table width="100%" class="fontcss"><tr><td align="center"><asp:Label ID="Label1" runat="server"  Text="No data to display !" Font-Size="Larger" ForeColor="maroon"> </asp:Label></td></tr></table></EmptyDataTemplate></asp:GridView><br /></asp:Panel></td></tr><tr><td align="center"><asp:Button 
                                    ID="btnProceed_Creditor" runat="server" CssClass="redbox" 
                                    onclientclick="return confirmationAdd();" Text="Proceed" 
                                    ValidationGroup="z1" OnClick="btnProceed_Creditor_Click"   /></td></tr></table></ContentTemplate></cc1:TabPanel><cc1:TabPanel ID="TabPanel_Sal" runat="server" HeaderText="Salary"><HeaderTemplate>Salary</HeaderTemplate><ContentTemplate><asp:Panel ID="plnSalary" ScrollBars="Auto" runat="server" ><table cellpadding="0" cellspacing="0" width="100%"><tr><td >Payment Against : </td><td >Salary</td><td height="25" valign="middle">Pay To :</td><td height="25" valign="middle"><asp:TextBox ID="txtPayTo_Sal" runat="server" CssClass="box3" Width="70%"></asp:TextBox><cc1:AutoCompleteExtender ID="AutoCompleteExtender1" runat="server" 
                                            CompletionInterval="100" CompletionListCssClass="almt" 
                                            CompletionListHighlightedItemCssClass="bgtext" CompletionListItemCssClass="bg" 
                                            CompletionSetCount="2" DelimiterCharacters="" Enabled="True" 
                                            FirstRowSelected="True" MinimumPrefixLength="1" 
                                            ServiceMethod="Sql2" ServicePath="" 
                                            ShowOnlyCurrentWordInCompletionListItem="True" TargetControlID="txtPayTo_Sal" 
                                            UseContextKey="True"></cc1:AutoCompleteExtender><asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" 
                                            ControlToValidate="txtPayTo_Sal" ErrorMessage="*" ValidationGroup="B"> </asp:RequiredFieldValidator></td><td  >&#160;</td></tr><tr><td >Cheque No./ D.D.No.:</td><td ><asp:TextBox ID="TxtChequeNo_Sal" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator4" runat="server" 
                                            ControlToValidate="TxtChequeNo_Sal" ErrorMessage="*" ValidationGroup="B"></asp:RequiredFieldValidator></td><td height="25" valign="middle">Cheque Date :</td><td height="25" valign="middle"><asp:TextBox 
                                ID="TxtChequeDate_Sal" runat="server" CssClass="box3" Width="70%"></asp:TextBox><cc1:CalendarExtender ID="CalendarExtender1" runat="server" 
                                            Enabled="True" Format="dd-MM-yyyy" TargetControlID="TxtChequeDate_Sal"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="RequiredFieldValidator5" ValidationGroup="B"  runat="server" 
                                            ControlToValidate="TxtChequeDate_Sal" ErrorMessage="*"> </asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegularExpressionValidator1" runat="server" 
                                            ControlToValidate="TxtChequeDate_Sal" ErrorMessage="*"  ValidationGroup="B" 
                                            ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$"> </asp:RegularExpressionValidator></td><td >&#160;</td></tr><tr><td >Drawn On :</td><td ><asp:DropDownList ID="DropDownList2" runat="server" CssClass="box3" 
                                            DataSourceID="SqlDataSource3" DataTextField="Name" DataValueField="Id"></asp:DropDownList></td><td>Payable At :</td><td><asp:TextBox 
                                ID="txtPayAt_Sal" runat="server" CssClass="box3" Width="70%"></asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator6" runat="server" 
                                            ControlToValidate="txtPayAt_Sal" ErrorMessage="*" ValidationGroup="B"></asp:RequiredFieldValidator></td><td ></td></tr><tr><td >&#160;&nbsp;</td></tr></table></asp:Panel><table width="100%"><tr><td><asp:Panel ID="Panel9" runat="server" 
                Height="280px" ScrollBars="Auto"><asp:GridView ID="GridView2"  
                runat="server"
                ShowFooter="True" 
                AutoGenerateColumns="False" 
                DataKeyNames="Id"
              OnRowCommand="GridView2_RowCommand" CssClass="yui-datatable-theme" Width="100%" 
                    onrowdatabound="GridView2_RowDataBound" 
                    onrowupdating="GridView2_RowUpdating" AllowPaging="True" 
                                            onrowcancelingedit="GridView2_RowCancelingEdit" 
                                            onrowdeleting="GridView2_RowDeleting" 
                                        onrowediting="GridView2_RowEditing" 
                                        onpageindexchanging="GridView2_PageIndexChanging" PageSize="13"><Columns><asp:TemplateField ShowHeader="False"><ItemTemplate><asp:LinkButton ID="LinkButton4" OnClientClick="return confirmationUpdate();" runat="server" CausesValidation="False" 
                                   CommandName="Edit" Text="Edit"> </asp:LinkButton></ItemTemplate><EditItemTemplate><asp:LinkButton ID="LinkButton1" runat="server" CausesValidation="True" ValidationGroup="Shree"
                                   CommandName="Update" Text="Update"> </asp:LinkButton>&nbsp;<asp:LinkButton ID="LinkButton2" runat="server" CausesValidation="False" 
                                   CommandName="Cancel" Text="Cancel"></asp:LinkButton>
                </EditItemTemplate><ItemStyle HorizontalAlign="Center" Width="6%" /></asp:TemplateField><asp:TemplateField ShowHeader="False"><ItemTemplate><asp:LinkButton ID="LinkButton3" runat="server" OnClientClick="return confirmationDelete();" CausesValidation="False" 
                                   CommandName="Delete" Text="Delete"> </asp:LinkButton></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="4%" /></asp:TemplateField><asp:TemplateField HeaderText="SN" SortExpression="Id"><ItemTemplate><%#Container.DataItemIndex+1  %></ItemTemplate><FooterTemplate><asp:Button ID="btnInsert" runat="server" Text="Insert" ValidationGroup="abc" 
                        OnClientClick=" return confirmationAdd()" CommandName="Add" CssClass="redbox" /></FooterTemplate><ItemStyle HorizontalAlign="Right" Width="2%" /></asp:TemplateField><asp:TemplateField HeaderText="Particulars"><ItemTemplate><asp:Label ID="lblParticulars" runat="server" Text='<%#Eval("Particular") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtParticulars" Width="99%" runat="server" CssClass="box3"  ValidationGroup="Shree" Text='<%#Bind("Particular") %>'> </asp:TextBox>
                </EditItemTemplate><FooterTemplate><asp:TextBox ID="txtParticularsFoot" CssClass="box3"   Width="99%" ValidationGroup="abc" runat="server"> </asp:TextBox></FooterTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Left" Width="30%" /></asp:TemplateField><asp:TemplateField HeaderText="Amount"><ItemTemplate><asp:Label ID="lblAmount" runat="server" Text='<%#Eval("Amount") %>'> </asp:Label></ItemTemplate><EditItemTemplate><asp:TextBox ID="txtAmount" Width="92%" runat="server" CssClass="box3"  ValidationGroup="Shree" Text='<%#Bind("Amount") %>'> </asp:TextBox><asp:RequiredFieldValidator ID="ReqAmountE" ValidationGroup="Shree" ControlToValidate="txtAmount" 
                            runat="server" ErrorMessage="*"> </asp:RequiredFieldValidator>
                </EditItemTemplate><FooterTemplate><asp:TextBox ID="txtAmountFoot" Width="92%" CssClass="box3"  ValidationGroup="abc" runat="server"> </asp:TextBox><asp:RequiredFieldValidator ID="ReqAmountF" runat="server" ValidationGroup="abc" ControlToValidate="txtAmountFoot" 
                         ErrorMessage="*"></asp:RequiredFieldValidator></FooterTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Right" Width="6%" /></asp:TemplateField></Columns><EmptyDataTemplate><table border="1pt" style="border-color:GrayText" width="100%"><tr><th>Particulars </th><th>Amount </th><th></th></tr><tr><td><asp:TextBox ID="txtparticul" runat="server" CssClass="box3" 
                                                        ValidationGroup="pqr" Width="99%"> </asp:TextBox></td><td><asp:TextBox ID="txtAmt" runat="server" CssClass="box3" ValidationGroup="pqr" 
                                                        Width="92%"> </asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator3" runat="server" 
                                                        ControlToValidate="txtAmt" ErrorMessage="*" ValidationGroup="pqr"></asp:RequiredFieldValidator></td><td><asp:Button ID="btnInsert" runat="server" CommandName="Add1" CssClass="redbox" 
                                                        OnClientClick=" return confirmationAdd()" Text="Insert" ValidationGroup="pqr" /></td></tr></table></EmptyDataTemplate><FooterStyle Wrap="True"></FooterStyle><PagerSettings PageButtonCount="20" /></asp:GridView></asp:Panel></td></tr><tr><td align="center" style="height:25px;"><asp:Button 
                                    ID="btnProceed_Sal" runat="server" CssClass="redbox" 
                                    onclientclick="return confirmationAdd();" Text="Proceed" 
                                    ValidationGroup="B" onclick="btnProceed_Sal_Click" /></td></tr></table></ContentTemplate></cc1:TabPanel><cc1:TabPanel ID="TabPanel_Others" runat="server" HeaderText="Others"><HeaderTemplate>Others</HeaderTemplate><ContentTemplate><asp:Panel ID="Panel6" ScrollBars="Auto" runat="server" ><table cellpadding="0" cellspacing="0" width="100%"><tr 
            ><td >Payment Against : </td><td >Others</td><td height="25" valign="middle">Pay To :</td><td height="25" valign="middle" align="right"><asp:DropDownList 
            ID="drptypeOther" runat="server" AutoPostBack="True" 
            OnSelectedIndexChanged="drptypeOther_SelectedIndexChanged"><asp:ListItem 
            Value="0">Select</asp:ListItem><asp:ListItem Value="1">Employee</asp:ListItem><asp:ListItem 
            Value="2">Customer</asp:ListItem><asp:ListItem Value="3">Supplier</asp:ListItem>
        </asp:DropDownList></td><td height="25" valign="middle" width="1%"  >&nbsp;</td><td height="25" valign="middle"><asp:TextBox ID="txtPayTo_Others" runat="server" CssClass="box3" Width="70%"></asp:TextBox><cc1:AutoCompleteExtender ID="AutoCompleteExtender2" runat="server" 
                        CompletionInterval="100" CompletionListCssClass="almt" 
                        CompletionListHighlightedItemCssClass="bgtext" CompletionListItemCssClass="bg" 
                        CompletionSetCount="2" DelimiterCharacters="" Enabled="True" 
                        FirstRowSelected="True" MinimumPrefixLength="1" 
                        ServiceMethod="GetCompletionList" ServicePath="" 
                        ShowOnlyCurrentWordInCompletionListItem="True" 
                        TargetControlID="txtPayTo_Others" UseContextKey="True"></cc1:AutoCompleteExtender><asp:RequiredFieldValidator ID="RequiredFieldValidator7" runat="server" 
                        ControlToValidate="txtPayTo_Others" ErrorMessage="*" ValidationGroup="z"></asp:RequiredFieldValidator></td><td>&#160;</td></tr><tr><td >Cheque No./ D.D.No.:</td><td ><asp:TextBox ID="txtChqNo" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator8" runat="server" 
                                            ControlToValidate="txtChqNo" ErrorMessage="*" ValidationGroup="z"></asp:RequiredFieldValidator></td><td 
            height="25" valign="middle" colspan="2">Cheque Date :</td><td height="25" valign="middle">&nbsp;</td><td height="25" valign="middle" ><asp:TextBox ID="txtChq_Date" runat="server" CssClass="box3" Width="70%"></asp:TextBox><cc1:CalendarExtender ID="CalendarExtender2" runat="server" Enabled="True" 
                            Format="dd-MM-yyyy" TargetControlID="txtChq_Date"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="RequiredFieldValidator9" runat="server" 
                            ControlToValidate="txtChq_Date" ErrorMessage="*" ValidationGroup="z"></asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegularExpressionValidator2" runat="server" 
                            ControlToValidate="txtChq_Date" ErrorMessage="*" 
                            ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$" 
                            ValidationGroup="z"></asp:RegularExpressionValidator></td><td>&#160;</td></tr><tr><td >Drawn On :</td><td ><asp:DropDownList ID="DropDownList3" runat="server" CssClass="box3" 
                                            DataSourceID="SqlDataSource5" DataTextField="Name" DataValueField="Id"></asp:DropDownList></td><td 
            colspan="2">Payable At :</td><td>&nbsp;</td><td ><asp:TextBox ID="txtpayAt_oth" runat="server" CssClass="box3" Width="70%"></asp:TextBox><asp:RequiredFieldValidator ID="RequiredFieldValidator10" runat="server" 
                        ControlToValidate="txtpayAt_oth" ErrorMessage="*" ValidationGroup="z"></asp:RequiredFieldValidator></td><td></td></tr><tr><td >&#160;&nbsp;</td></tr></table></asp:Panel><table width="100%"><tr><td><asp:Panel ID="Panel7" runat="server" 
                ScrollBars="Auto"><asp:GridView ID="GridView3"  
                runat="server"
                ShowFooter="True" 
                AutoGenerateColumns="False" 
                DataKeyNames="Id"
              OnRowCommand="GridView3_RowCommand" CssClass="yui-datatable-theme" Width="100%" 
                    onrowupdating="GridView3_RowUpdating" AllowPaging="True" 
                              onrowediting="GridView3_RowEditing" 
                             onrowcancelingedit="GridView3_RowCancelingEdit" 
                             onrowdeleting="GridView3_RowDeleting" 
                onpageindexchanging="GridView3_PageIndexChanging" PageSize="17"><Columns><asp:TemplateField ShowHeader="False"><EditItemTemplate><asp:LinkButton ID="LinkButton1" ValidationGroup="Shree" runat="server" CausesValidation="True" 
                                   CommandName="Update" Text="Update"> </asp:LinkButton>&nbsp;<asp:LinkButton ID="LinkButton2" runat="server" CausesValidation="False" 
                                   CommandName="Cancel" Text="Cancel"></asp:LinkButton></EditItemTemplate><ItemTemplate><asp:LinkButton ID="LinkButton4" OnClientClick="return confirmationUpdate();" runat="server" CausesValidation="False" 
                                   CommandName="Edit" Text="Edit"> </asp:LinkButton></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="4%" /></asp:TemplateField><asp:TemplateField ShowHeader="False"><ItemTemplate><asp:LinkButton ID="LinkButton3" runat="server" OnClientClick="return confirmationDelete();" CausesValidation="False" 
                                   CommandName="Delete" Text="Delete"> </asp:LinkButton></ItemTemplate><ItemStyle HorizontalAlign="Center" Width="3%" /></asp:TemplateField><asp:TemplateField HeaderText="SN" SortExpression="Id"><FooterTemplate><asp:Button ID="btnInsert" runat="server" Text="Insert" ValidationGroup="abc" 
                        OnClientClick=" return confirmationAdd()" CommandName="Add" CssClass="redbox" /></FooterTemplate><ItemTemplate><%#Container.DataItemIndex+1  %></ItemTemplate><ItemStyle HorizontalAlign="Right" Width="2%" /></asp:TemplateField><asp:TemplateField HeaderText="Within Group"><EditItemTemplate><asp:TextBox ID="txtwithGr" Width="99%" runat="server" CssClass="box3" Text='<%#Bind("WithinGroup") %>'> </asp:TextBox></EditItemTemplate><FooterTemplate><asp:TextBox ID="txtwithingrFt" CssClass="box3"   Width="85%" ValidationGroup="abc" runat="server"> </asp:TextBox><asp:RequiredFieldValidator ID="ReqWithinF" runat="server" ValidationGroup="abc" ControlToValidate="txtwithingrFt" 
                         ErrorMessage="*"></asp:RequiredFieldValidator></FooterTemplate><ItemTemplate><asp:Label ID="lblWithinGroup" runat="server" Text='<%#Eval("WithinGroup") %>'> </asp:Label></ItemTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Left" Width="15%" /></asp:TemplateField><asp:TemplateField HeaderText="Id" Visible="False"  ><EditItemTemplate><asp:Label ID="lblIdE" runat="server" Text='<%#Eval("Id") %>'> </asp:Label></EditItemTemplate><ItemTemplate><asp:Label ID="lblId" runat="server" Text='<%#Eval("Id") %>'> </asp:Label></ItemTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Left" Width="6%" /></asp:TemplateField><asp:TemplateField HeaderText="WO No/BG Group"><EditItemTemplate><asp:RadioButtonList 
                                ID="RadioButtonWONoGroupE" runat="server" AutoPostBack="True" 
                                                    RepeatDirection="Horizontal" onselectedindexchanged="RadioButtonWONoGroupE_SelectedIndexChanged" 
                                    ><asp:ListItem Value="0" Selected="True"> WO No </asp:ListItem><asp:ListItem Value="1"> Group </asp:ListItem></asp:RadioButtonList></EditItemTemplate><FooterTemplate><asp:RadioButtonList 
                                ID="RadioButtonWONoGroupF" runat="server" AutoPostBack="True" 
                                                    RepeatDirection="Horizontal" onselectedindexchanged="RadioButtonWONoGroupF_SelectedIndexChanged" 
                                    ><asp:ListItem Value="0" Selected="True"> WO No </asp:ListItem><asp:ListItem Value="1"> Group </asp:ListItem></asp:RadioButtonList></FooterTemplate><ItemTemplate><asp:RadioButtonList 
                                ID="RadioButtonWONoGroup1" runat="server" AutoPostBack="True" 
                                                    RepeatDirection="Horizontal" 
                                    ><asp:ListItem Value="0" Selected="True"> WO No </asp:ListItem><asp:ListItem Value="1"> Group </asp:ListItem></asp:RadioButtonList></ItemTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Left" Width="12%" /></asp:TemplateField><asp:TemplateField HeaderText="WONo"><EditItemTemplate><asp:TextBox 
                                    ID="txtWONoE" runat="server" CssClass="box3"> </asp:TextBox></EditItemTemplate><FooterTemplate><asp:TextBox 
                                    ID="txtWONoF" runat="server" Width="83%" CssClass="box3"> </asp:TextBox><asp:RequiredFieldValidator 
                                    ID="RequiredFieldtxtWONoF" runat="server" ValidationGroup="abc" ControlToValidate="txtWONoF" 
                                    ErrorMessage="*" > </asp:RequiredFieldValidator></FooterTemplate><ItemTemplate><asp:Label ID="lblWONo" runat="server" Text='<%#Eval("WONo") %>'> </asp:Label></ItemTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Center" Width="5%" /></asp:TemplateField><asp:TemplateField HeaderText="BG"><EditItemTemplate><asp:DropDownList ID="drpGroupE" DataSourceID="SqlDataBG" 
                    DataTextField="Symbol"  Visible="false" DataValueField="Id" runat="server"></asp:DropDownList></EditItemTemplate><FooterTemplate><asp:DropDownList ID="drpGroupF" runat="server" DataSourceID="SqlDataBG" 
                    DataTextField="Symbol"   Visible="false" DataValueField="Id"></asp:DropDownList></FooterTemplate><ItemTemplate><asp:Label ID="lblBG" runat="server" Visible="true" Text='<%#Eval("BG") %>'> </asp:Label></ItemTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Center" Width="4%" /></asp:TemplateField><asp:TemplateField HeaderText="Particulars"><EditItemTemplate><asp:TextBox ID="txtParticulars" Width="99%" runat="server" CssClass="box3"  ValidationGroup="Shree" Text='<%#Bind("Particular") %>'> </asp:TextBox></EditItemTemplate><FooterTemplate><asp:TextBox ID="txtParticularsFoot" CssClass="box3"   Width="99%" ValidationGroup="abc" runat="server"> </asp:TextBox></FooterTemplate><ItemTemplate><asp:Label ID="lblParticulars" runat="server" Text='<%#Eval("Particular") %>'> </asp:Label></ItemTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Left" Width="30%" /></asp:TemplateField><asp:TemplateField HeaderText="Amount"><EditItemTemplate><asp:TextBox ID="txtAmount" Width="90%" runat="server" CssClass="box3"  Text='<%#Bind("Amount") %>'> </asp:TextBox><asp:RequiredFieldValidator ID="ReqAmountE" ValidationGroup="Shree" ControlToValidate="txtAmount" 
                            runat="server" ErrorMessage="*"> </asp:RequiredFieldValidator></EditItemTemplate><FooterTemplate><asp:TextBox ID="txtAmountFoot" Width="85%" CssClass="box3"  ValidationGroup="abc" runat="server"> </asp:TextBox><asp:RequiredFieldValidator ID="ReqAmountF" runat="server" ValidationGroup="abc" ControlToValidate="txtAmountFoot" 
                         ErrorMessage="*"></asp:RequiredFieldValidator></FooterTemplate><ItemTemplate><asp:Label ID="lblAmount" runat="server" Text='<%#Eval("Amount") %>'> </asp:Label></ItemTemplate><FooterStyle HorizontalAlign="Left" /><ItemStyle HorizontalAlign="Right" Width="6%" /></asp:TemplateField></Columns><EmptyDataTemplate><table border="1pt" style="border-color:GrayText" width="100%"><tr><th>Within Group </th><th>WONo/BG Group </th><th></th><th>Particulars </th><th>Amount </th><th></th></tr><tr><td><asp:TextBox ID="txtwithinGr" runat="server" CssClass="box3" Width="92%"> </asp:TextBox><asp:RequiredFieldValidator 
                                        ID="RequiredFieldValidator11" runat="server" ControlToValidate="txtwithinGr" 
                                        ErrorMessage="*" ValidationGroup="pqr2"></asp:RequiredFieldValidator></td><td><asp:RadioButtonList ID="RadioButtonWONoGroup" runat="server" AutoPostBack="True" 
                                   onselectedindexchanged="RadioButtonWONoGroup_SelectedIndexChanged" 
                                   RepeatDirection="Horizontal"><asp:ListItem Selected="True" Value="0">WO No</asp:ListItem><asp:ListItem 
                                   Value="1">Group</asp:ListItem></asp:RadioButtonList></td><td><asp:TextBox ID="txtWONo" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator 
                                        ID="RequiredFieldtxtWONo" runat="server" ControlToValidate="txtWONo" 
                                        ErrorMessage="*" ValidationGroup="pqr2"></asp:RequiredFieldValidator><asp:DropDownList ID="drpGroup" runat="server" DataSourceID="SqlDataBG" 
                                        DataTextField="Symbol" DataValueField="Id" Visible="false"></asp:DropDownList></td><td><asp:TextBox ID="txtparticul" runat="server" CssClass="box3" Width="99%"> </asp:TextBox></td><td><asp:TextBox ID="txtAmt" runat="server" CssClass="box3" ValidationGroup="pqr2" 
                                    Width="92%"> </asp:TextBox><asp:RequiredFieldValidator 
                                    ID="RequiredFieldValidator3" runat="server" ControlToValidate="txtAmt" 
                                    ErrorMessage="*" ValidationGroup="pqr2"></asp:RequiredFieldValidator></td><td><asp:Button 
                                        ID="btnInsert" runat="server" CommandName="Add1" CssClass="redbox" 
                                        OnClientClick=" return confirmationAdd()" Text="Insert" 
                                        ValidationGroup="pqr2" /></td></tr></table></EmptyDataTemplate><FooterStyle Wrap="True"></FooterStyle></asp:GridView></asp:Panel></td></tr><tr><td align="center" style="height:25px"><asp:Button 
                                    ID="btnProceed_Oth" runat="server" CssClass="redbox" 
                                    onclientclick="return confirmationAdd();" Text="Proceed" 
                                    ValidationGroup="z" onclick="btnProceed_Oth_Click"  /></td></tr></table></ContentTemplate></cc1:TabPanel></cc1:TabContainer></asp:Panel>
                    
                    </ContentTemplate></cc1:TabPanel>
                    
                    <cc1:TabPanel ID="View" runat="server" HeaderText="Receipt">
                            
                        <ContentTemplate><asp:Panel ID="Panel2" ScrollBars="Auto" runat="server"><table width="100%"><tr><td>&#160;</td><td>&#160;</td><td>&#160;</td><td>&#160;</td><td>&#160;</td></tr><tr><td>Receipt Against</td><td><asp:DropDownList ID="DrpTypes" runat="server" AutoPostBack="True"  
                                  CssClass="box3" OnSelectedIndexChanged="DrpTypes_SelectedIndexChanged"></asp:DropDownList><asp:RequiredFieldValidator ID="ReqDrpType" runat="server" ValidationGroup="M"
                                    ControlToValidate="DrpTypes" InitialValue="Select" ErrorMessage="*"></asp:RequiredFieldValidator></td><td>Received From</td><td><asp:TextBox ID="TxtFrom" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator ID="ReqFrom" runat="server" ValidationGroup="M"
                                    ControlToValidate="TxtReceived" ErrorMessage="*"></asp:RequiredFieldValidator></td><td>&#160;</td></tr><tr><td>Invoice No</td><td><asp:TextBox ID="TxtInvoiceNo" runat="server" CssClass="box3">0</asp:TextBox></td><td>Amount </td><td><asp:TextBox ID="TxtAmount" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator ID="ReqAmount" runat="server" ValidationGroup="M"
                                    ControlToValidate="TxtAmount" ErrorMessage="*"></asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegularExpressionValidator4" runat="server" 
                                    ControlToValidate="TxtAmount" ErrorMessage="*" 
                                    ValidationExpression="^\d{1,15}(\.\d{0,3})?$" ValidationGroup="M"></asp:RegularExpressionValidator></td><td>&#160;</td></tr><tr><td>Cheque No</td><td><asp:TextBox ID="TxtChequeNo" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator ID="ReqChequeNo" runat="server" ValidationGroup="M"
                                    ControlToValidate="TxtChequeNo" ErrorMessage="*"></asp:RequiredFieldValidator></td><td>Cheque Date</td><td><asp:TextBox ID="TxtChequeDate" runat="server" CssClass="box3"></asp:TextBox><cc1:CalendarExtender ID="TxtChequeDate_CalendarExtender" runat="server" 
                                    Enabled="True" Format="dd-MM-yyyy" TargetControlID="TxtChequeDate"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="ReqChequeDate" runat="server" ValidationGroup="M"
                                    ControlToValidate="TxtChequeDate" ErrorMessage="*"></asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegBillDate0" runat="server" 
                                    ControlToValidate="TxtChequeDate" ErrorMessage="*" 
                                    ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$" 
                                    ValidationGroup="M"></asp:RegularExpressionValidator></td><td><asp:CompareValidator ID="CompareValidator1" ValidationGroup="M" runat="server" 
                                    ControlToValidate = "TxtChequeDate" ControlToCompare = "TxtClearanceDate" 
                                    Operator ="LessThanEqual" Type = "Date" 
                                    ErrorMessage="Cheque date must be less than or equal to Clearance date."></asp:CompareValidator></td></tr><tr><td>Cheque Received By</td><td><asp:TextBox ID="TxtReceived" runat="server" CssClass="box3"></asp:TextBox><cc1:AutoCompleteExtender ID="AutoCompleteExtenderR" runat="server" 
                        CompletionInterval="100"
                         CompletionListCssClass="almt" 
                        CompletionListHighlightedItemCssClass="bgtext"
                         CompletionListItemCssClass="bg" 
                        CompletionSetCount="2"
                         DelimiterCharacters="" Enabled="True" 
                        FirstRowSelected="True" 
                        MinimumPrefixLength="1" ServiceMethod="sql2" 
                        ServicePath=""
                         ShowOnlyCurrentWordInCompletionListItem="True" 
                        TargetControlID="TxtReceived" UseContextKey="True"></cc1:AutoCompleteExtender><asp:RequiredFieldValidator ID="RequiredFieldValidator16" runat="server" ValidationGroup="M" 
                                    ControlToValidate="TxtReceived" ErrorMessage="*"></asp:RequiredFieldValidator></td><td>Bank Name</td><td><asp:TextBox ID="TxtBank" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator ID="ReqReceived" runat="server" ValidationGroup="M"
                                    ControlToValidate="TxtBank" ErrorMessage="*"></asp:RequiredFieldValidator></td><td>&#160;</td></tr><tr><td>Bank Account No</td><td><asp:TextBox ID="TxtBankAccNo" runat="server" CssClass="box3"></asp:TextBox><asp:RequiredFieldValidator ID="ReqBankAccNo" runat="server" ValidationGroup="M"
                                    ControlToValidate="TxtBankAccNo" ErrorMessage="*"></asp:RequiredFieldValidator></td><td>Cheque Clearance Date</td><td><asp:TextBox ID="TxtClearanceDate" runat="server" CssClass="box3"></asp:TextBox><cc1:CalendarExtender ID="TxtClearanceDate_CalendarExtender" runat="server" 
                                    Enabled="True" Format="dd-MM-yyyy" TargetControlID="TxtClearanceDate"></cc1:CalendarExtender><asp:RequiredFieldValidator ID="ReqClearanceDate" runat="server" ValidationGroup="M"
                                    ControlToValidate="TxtClearanceDate" ErrorMessage="*"></asp:RequiredFieldValidator><asp:RegularExpressionValidator ID="RegBillDate" runat="server" 
                                    ControlToValidate="TxtClearanceDate" ErrorMessage="*" 
                                    ValidationExpression="^([1-9]|0[1-9]|[12][0-9]|3[01])[- /.]([1-9]|0[1-9]|1[012])[- /.][0-9]{4}$" 
                                    ValidationGroup="M"></asp:RegularExpressionValidator></td><td>&#160;</td></tr><tr><td>Narration</td><td><asp:TextBox ID="TxtNarration" runat="server" CssClass="box3" 
                                    TextMode="MultiLine"></asp:TextBox></td><td>&#160;</td><td><asp:Button ID="TxtSubmit" runat="server" CssClass="redbox"  ValidationGroup="M"
                                    onclick="TxtSubmit_Click" Text="Submit" /></td><td>&#160;</td></tr><tr><td colspan="5"><asp:GridView ID="GridView6" runat="server" AutoGenerateColumns="False" 
                                    CssClass="yui-datatable-theme" DataKeyNames="Id" 
                                    PageSize="15"  Width="100%"
                                    onrowcommand="GridView6_RowCommand"><Columns><asp:TemplateField HeaderText="SN"><ItemTemplate><%#Container.DataItemIndex+1%></ItemTemplate><HeaderStyle Font-Size="10pt" /><ItemStyle HorizontalAlign="Right" VerticalAlign="Top" Width="3%" /></asp:TemplateField><asp:TemplateField><ItemTemplate><asp:LinkButton ID="LinkButton1" OnClientClick="confirmationDelete()"  CommandName="Del" runat="server">Delete</asp:LinkButton>
                                    </ItemTemplate></asp:TemplateField><asp:TemplateField Visible="False"><ItemTemplate><asp:Label ID="lblId" runat="server" Text='<%#Eval("Id")%>'></asp:Label>
                                    </ItemTemplate></asp:TemplateField><asp:BoundField DataField="FinYear" HeaderText="Fin Year" 
                                            SortExpression="FinYearId"  /><asp:BoundField DataField="ADRNo" 
                                    HeaderText="ADRNo" SortExpression="BVRNo" ><ItemStyle HorizontalAlign="Center" /></asp:BoundField><asp:BoundField DataField="Types" HeaderText="Receipt Against" 
                                            SortExpression="Types" /><asp:BoundField DataField="ReceivedFrom" HeaderText="Received From" 
                                            SortExpression="ReceivedFrom" /><asp:BoundField DataField="InvoiceNo" HeaderText="Invoice No" 
                                            SortExpression="InvoiceNo" ><ItemStyle HorizontalAlign="Center" /></asp:BoundField><asp:BoundField DataField="ChequeNo" HeaderText="Cheque No" 
                                            SortExpression="ChequeNo" ><ItemStyle HorizontalAlign="Center" /></asp:BoundField><asp:BoundField DataField="ChequeDate" HeaderText="Cheque Date" 
                                            SortExpression="ChequeDate" ><ItemStyle HorizontalAlign="Center" /></asp:BoundField><asp:BoundField DataField="ChequeReceivedBy" HeaderText="Cheque Recd By" 
                                            SortExpression="ChequeReceivedBy" ><ItemStyle Width="15%" /></asp:BoundField><asp:BoundField DataField="BankName" HeaderText="Bank Name" 
                                            SortExpression="BankName" /><asp:BoundField DataField="BankAccNo" HeaderText="Bank AccNo" 
                                            SortExpression="BankAccNo" /><asp:BoundField DataField="ChequeClearanceDate" HeaderText="Clearance Date" 
                                            SortExpression="ChequeClearanceDate" ><ItemStyle HorizontalAlign="Center" /></asp:BoundField><asp:BoundField DataField="Narration" HeaderText="Narration" 
                                            SortExpression="Narration" /><asp:BoundField DataField="Amount" HeaderText="Amount" 
                                            SortExpression="Amount" ><ItemStyle HorizontalAlign="Right" /></asp:BoundField></Columns><EmptyDataTemplate><table width="100%" class="fontcss"><tr><td align="center"><asp:Label ID="Label1" runat="server"  Text="No data to display !" Font-Size="Larger" ForeColor="maroon"> </asp:Label></td></tr></table></EmptyDataTemplate></asp:GridView></td></tr></table></asp:Panel>
                    
                           
                    
                    </ContentTemplate></cc1:TabPanel>
                    
                </cc1:TabContainer>
                <asp:SqlDataSource ID="SqlDataSource2" runat="server" 
                   ConnectionString="<%$ ConnectionStrings:LocalSqlServer %>"
                    ProviderName="System.Data.SqlClient" 
                    
                    SelectCommand="SELECT * FROM [tblACC_Advice_Payment_Temp] WHERE (([SessionId] = @SessionId) AND ([CompId] = @CompId) And ([Types]=1))" 
                    ConflictDetection="OverwriteChanges" 
                    DeleteCommand="DELETE FROM [tblACC_Advice_Payment_Temp] WHERE [Id] = @original_Id" 
                    InsertCommand="INSERT INTO [tblACC_Advice_Payment_Temp] ([ProformaInvNo], [InvDate], [PONo], [Amount], [Particular], [CompId], [SessionId],[Types]) VALUES (@ProformaInvNo, @InvDate, @PONo, @Amount, @Particular, @CompId, @SessionId,@Types)" 
                    OldValuesParameterFormatString="original_{0}" 
                    UpdateCommand="UPDATE [tblACC_Advice_Payment_Temp] SET [ProformaInvNo] = @ProformaInvNo, [InvDate] = @InvDate, [PONo] = @PONo, [Amount] = @Amount, [Particular] = @Particular, [CompId] = @CompId, [SessionId] = @SessionId WHERE [Id] = @original_Id">
                    <SelectParameters>
                        <asp:SessionParameter Name="SessionId" SessionField="username" Type="String" />
                        <asp:SessionParameter Name="CompId" SessionField="compid" Type="Int32" />
                       
                    </SelectParameters>
                    <DeleteParameters>
                        <asp:Parameter Name="original_Id" Type="Int32" />
                        
                    </DeleteParameters>
                    <UpdateParameters>
                        <asp:Parameter Name="ProformaInvNo" Type="String" />
                        <asp:Parameter Name="InvDate" Type="String" />
                        <asp:Parameter Name="PONo" Type="String" />
                        <asp:Parameter Name="Amount" Type="Double" />
                        <asp:Parameter Name="Particular" Type="String" />
                        <asp:Parameter Name="CompId" Type="Int32" />
                        <asp:Parameter Name="SessionId" Type="String" />
                        <asp:Parameter Name="original_Id" Type="Int32" />                        
                    </UpdateParameters>
                    <InsertParameters>
                        <asp:Parameter Name="ProformaInvNo" Type="String" />
                        <asp:Parameter Name="InvDate" Type="String" />
                        <asp:Parameter Name="PONo" Type="String" />
                        <asp:Parameter Name="Amount" Type="Double" />
                        <asp:Parameter Name="Particular" Type="String" />
                        <asp:Parameter Name="CompId" Type="Int32" />
                        <asp:Parameter Name="SessionId" Type="String" />
                         <asp:Parameter Name="Types" Type="Int32" />
                    </InsertParameters>
                </asp:SqlDataSource>                
                 <asp:SqlDataSource 
        runat="server" ConnectionString="<%$ ConnectionStrings:LocalSqlServer %>" 
        ProviderName="System.Data.SqlClient" 
        SelectCommand="SELECT DISTINCT * FROM [tblACC_Bank]" ID="SqlDataSource1"></asp:SqlDataSource><asp:SqlDataSource runat="server" ConnectionString="<%$ ConnectionStrings:LocalSqlServer %>" ProviderName="System.Data.SqlClient" SelectCommand="SELECT DISTINCT * FROM [tblACC_Bank]" ID="SqlDataSource3">
        </asp:SqlDataSource><asp:SqlDataSource runat="server" ConnectionString="<%$ ConnectionStrings:LocalSqlServer %>" ProviderName="System.Data.SqlClient" SelectCommand="SELECT DISTINCT * FROM [tblACC_Bank]" ID="SqlDataSource5">
    </asp:SqlDataSource><asp:SqlDataSource 
        runat="server" ConnectionString="<%$ ConnectionStrings:LocalSqlServer %>" 
        ProviderName="System.Data.SqlClient" 
        SelectCommand="SELECT DISTINCT * FROM [tblACC_Bank]" ID="SqlDataSource6">
    </asp:SqlDataSource>
                        
             
               <asp:SqlDataSource ID="SqlDataBG" runat="server" 
                    ConnectionString="<%$ ConnectionStrings:LocalSqlServer %>"
                    ProviderName="System.Data.SqlClient" 
                    SelectCommand="SELECT * FROM [BusinessGroup]"></asp:SqlDataSource>
                
                
                
            </td>
        </tr>
        
        </table>
 
 
</asp:Content>
<asp:Content ID="Content8" ContentPlaceHolderID="ContentPlaceHolder4" Runat="Server">
</asp:Content>



=== FILE: /Users/shiv/workspace/syncortext/NewERP/Module/Accounts/Transactions/Advice.aspx.cs ===

ï»¿using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Data.SqlClient;

public partial class Module_Accounts_Transactions_Advice : System.Web.UI.Page
{

    clsFunctions fun = new clsFunctions();
    string connStr = "";
    SqlConnection con;
    int CompId = 0;
    int FinYearId = 0;
    string sId = "";
    string CDate = "";
    string CTime = "";


    protected void Page_Load(object sender, EventArgs e)
    {
       try
        {
            connStr = fun.Connection();
            con = new SqlConnection(connStr);
            CompId = Convert.ToInt32(Session["compid"]);
            FinYearId = Convert.ToInt32(Session["finyear"]);
            sId = Session["username"].ToString();
            CDate = fun.getCurrDate();
            CTime = fun.getCurrTime();
          if (!Page.IsPostBack)
            {


                SqlCommand cmd = new SqlCommand("DELETE FROM tblACC_Advice_Payment_Temp WHERE SessionId='" + sId + "' And CompId='" + CompId + "'", con);
                con.Open();
                cmd.ExecuteNonQuery();
                con.Close();

                SqlCommand cmd1 = new SqlCommand("DELETE FROM tblACC_Advice_Payment_Creditor_Temp WHERE SessionId='" + sId + "' And CompId='" + CompId + "'", con);
                con.Open();
                cmd1.ExecuteNonQuery();
                con.Close();
                this.FillGrid_Other();
                this.FillGrid_Creditors_Temp();
                this.FillGrid_Salary();
                this.FillGrid_Creditors();
                this.dropdownCompany(DrpTypes);
                this.Loaddata();


            }
        }
       catch (Exception ex)
        {
        }
    }

    public void GetValidate()
    {
        try
        {
            foreach (GridViewRow grv in GridView4.Rows)
            {
                if (((CheckBox)grv.FindControl("ck")).Checked == true)
                {


                    ((RequiredFieldValidator)grv.FindControl("Req16")).Visible = true;
                    ((RequiredFieldValidator)grv.FindControl("ReqBillAgainst")).Visible = true;
                }
                else
                {

                    ((RequiredFieldValidator)grv.FindControl("Req16")).Visible = false;
                    ((RequiredFieldValidator)grv.FindControl("ReqBillAgainst")).Visible = false;
                }
            }
        }

        catch (Exception ex) { }

    }
    protected void btnProceed_Click(object sender, EventArgs e)
    {
        try
        {
            string connStr = fun.Connection();
            SqlConnection con = new SqlConnection(connStr);
            DataSet DS = new DataSet();
            CDate = fun.getCurrDate();
            CTime = fun.getCurrTime();
            string PayTo = fun.getCode(TextBox1.Text);
            string cmdStr = fun.select("ADNo", "tblACC_Advice_Payment_Master", "CompId='" + CompId + "' AND FinYearId='" + FinYearId + "' order by Id desc");
            SqlCommand cmd1 = new SqlCommand(cmdStr, con);
            SqlDataAdapter da = new SqlDataAdapter(cmd1);
            da.Fill(DS, "tblACC_Advice_Payment_Master");
            string ADNo;
            if (DS.Tables[0].Rows.Count > 0)
            {
                int bvno = Convert.ToInt32(DS.Tables[0].Rows[0][0].ToString()) + 1;
                ADNo = bvno.ToString("D4");
            }
            else
            {
                ADNo = "0001";
            }
            int EmpSupId = fun.chkEmpCustSupplierCode(PayTo, Convert.ToInt32(drptype.SelectedValue), CompId);

            string sql5 = fun.select("*", "tblACC_Advice_Payment_Temp", "CompId='" + CompId + "' AND SessionId='" + sId + "' And Types='1'");
            SqlCommand cmd5 = new SqlCommand(sql5, con);
            SqlDataAdapter da5 = new SqlDataAdapter(cmd5);
            DataSet DS5 = new DataSet();
            da5.Fill(DS5);

            if (DS5.Tables[0].Rows.Count > 0)
            {

                if (EmpSupId == 1 && TextBox1.Text != "" && txtDDNo.Text != "" && txtPayAt.Text != "" && textChequeDate.Text != "" && fun.DateValidation(textChequeDate.Text) == true && drptype.SelectedValue != "0")
                {
                    string StrBVPMaster = fun.insert("tblACC_Advice_Payment_Master", "SysDate,SysTime,SessionId,CompId,FinYearId,ADNo,Type,PayTo,ChequeNo,ChequeDate,PayAt,Bank,ECSType", "'" + CDate + "','" + CTime + "','" + sId + "','" + CompId + "','" + FinYearId + "','" + ADNo + "','1','" + PayTo + "','" + txtDDNo.Text + "','" + fun.FromDate(textChequeDate.Text) + "','" + txtPayAt.Text + "','" + DropDownList1.SelectedValue + "','" + Convert.ToInt32(drptype.SelectedValue) + "'");
                    SqlCommand cmd11 = new SqlCommand(StrBVPMaster, con);
                    con.Open();
                    cmd11.ExecuteNonQuery();
                    con.Close();

                    string sqlMId = fun.select("Id", "tblACC_Advice_Payment_Master", "CompId='" + CompId + "' AND ADNo='" + ADNo + "' Order By Id Desc");
                    SqlCommand cmdMId = new SqlCommand(sqlMId, con);
                    SqlDataAdapter DAMId = new SqlDataAdapter(cmdMId);
                    DataSet DSMId = new DataSet();
                    DAMId.Fill(DSMId);
                    string MId = DSMId.Tables[0].Rows[0]["Id"].ToString();

                    for (int p = 0; p < DS5.Tables[0].Rows.Count; p++)
                    {
                        string StrCVPDetails = fun.insert("tblACC_Advice_Payment_Details", "MId ,ProformaInvNo ,InvDate,PONo,Particular,Amount", "'" + MId + "','" + DS5.Tables[0].Rows[p]["ProformaInvNo"].ToString() + "','" + fun.FromDate(DS5.Tables[0].Rows[p]["InvDate"].ToString()) + "','" + DS5.Tables[0].Rows[p]["PONo"].ToString() + "','" + DS5.Tables[0].Rows[p]["Particular"].ToString() + "','" + Convert.ToDouble(decimal.Parse(DS5.Tables[0].Rows[p]["Amount"].ToString()).ToString("N2")) + "'");
                        SqlCommand cmd15 = new SqlCommand(StrCVPDetails, con);
                        con.Open();
                        cmd15.ExecuteNonQuery();
                        con.Close();
                    }
                    string delsql = fun.delete("tblACC_Advice_Payment_Temp", "CompId='" + CompId + "' AND SessionId='" + sId + "'And Types='1'");
                    SqlCommand cmd12 = new SqlCommand(delsql, con);
                    con.Open();
                    cmd12.ExecuteNonQuery();
                    con.Close();
                    Page.Response.Redirect(Page.Request.Url.ToString(), true);
                }
                else
                {
                    string myStringVariable = string.Empty;
                    myStringVariable = "Invalid data entry.";
                    ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
                }
            }
            else
            {
                string myStringVariable = string.Empty;
                myStringVariable = "Records are not found.";
                ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
            }

        }
        catch (Exception ex) { }

    }

    [System.Web.Services.WebMethodAttribute(), System.Web.Script.Services.ScriptMethodAttribute()]
    public static string[] GetCompletionList(string prefixText, int count, string contextKey)
    {
        clsFunctions fun = new clsFunctions();
        string connStr = fun.Connection();
        DataSet ds = new DataSet();
        SqlConnection con = new SqlConnection(connStr);
        con.Open();
        int CompId = Convert.ToInt32(HttpContext.Current.Session["compid"]);
        int CodeType = Convert.ToInt32(HttpContext.Current.Session["codetype1"]);

        switch (CodeType)
        {
            case 1:
                {
                    string cmdStr = fun.select("EmpId,EmployeeName", "tblHR_OfficeStaff", "CompId='" + CompId + "' Order By EmployeeName ASC");
                    SqlDataAdapter da = new SqlDataAdapter(cmdStr, con);
                    da.Fill(ds, "tblHR_OfficeStaff");
                }
                break;

            case 2:
                {
                    string cmdStr = fun.select("CustomerId,CustomerName", "SD_Cust_master", "CompId='" + CompId + "' Order By CustomerName ASC");
                    SqlDataAdapter da = new SqlDataAdapter(cmdStr, con);
                    da.Fill(ds, "SD_Cust_master");
                }
                break;

            case 3:
                {
                    string cmdStr = fun.select("SupplierId,SupplierName", "tblMM_Supplier_master", "CompId='" + CompId + "' Order By SupplierName ASC");
                    SqlDataAdapter da = new SqlDataAdapter(cmdStr, con);
                    da.Fill(ds, "tblMM_Supplier_master");
                }
                break;

        }

        con.Close();
        string[] main = new string[0];
        for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
        {
            if (ds.Tables[0].Rows[i].ItemArray[1].ToString().ToLower().StartsWith(prefixText.ToLower()))
            {
                Array.Resize(ref main, main.Length + 1);
                main[main.Length - 1] = ds.Tables[0].Rows[i].ItemArray[1].ToString() + " [" + ds.Tables[0].Rows[i].ItemArray[0].ToString() + "]";
                //if (main.Length == 15)
                //    break;
            }
        }
        Array.Sort(main);
        return main;
    }



    protected void GridView1_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        try
        {
            string ProformaInvNo = "";
            string InvDate = "";
            string PONo = "";
            double Amount = 0;
            string Particular = "";

            if (e.CommandName == "Add")
            {

                if (((TextBox)GridView1.FooterRow.FindControl("txtAmountFoot")).Text != "")
                {
                    ProformaInvNo = ((TextBox)GridView1.FooterRow.FindControl("txtProforInvNoFoot")).Text;
                    InvDate = ((TextBox)GridView1.FooterRow.FindControl("textDateF")).Text;
                    PONo = ((TextBox)GridView1.FooterRow.FindControl("txtPoNoFoot")).Text;
                    Amount = Convert.ToDouble(decimal.Parse(((TextBox)GridView1.FooterRow.FindControl("txtAmountFoot")).Text).ToString("N3"));
                    Particular = ((TextBox)GridView1.FooterRow.FindControl("txtParticularsFoot")).Text;
                    SqlDataSource2.InsertParameters["CompId"].DefaultValue = CompId.ToString();
                    SqlDataSource2.InsertParameters["SessionId"].DefaultValue = sId;
                    SqlDataSource2.InsertParameters["ProformaInvNo"].DefaultValue = ProformaInvNo;
                    SqlDataSource2.InsertParameters["InvDate"].DefaultValue = InvDate;
                    SqlDataSource2.InsertParameters["PONo"].DefaultValue = PONo;
                    SqlDataSource2.InsertParameters["Amount"].DefaultValue = Amount.ToString();
                    SqlDataSource2.InsertParameters["Particular"].DefaultValue = Particular;
                    SqlDataSource2.InsertParameters["Types"].DefaultValue = "1";
                    SqlDataSource2.Insert();
                }
            }
            if (e.CommandName == "Add1")
            {

                if (((TextBox)GridView1.Controls[0].Controls[0].FindControl("txtAmt")).Text != "")
                {
                    ProformaInvNo = ((TextBox)GridView1.Controls[0].Controls[0].FindControl("txtProInv")).Text;
                    InvDate = ((TextBox)GridView1.Controls[0].Controls[0].FindControl("txtDate1")).Text;
                    PONo = ((TextBox)GridView1.Controls[0].Controls[0].FindControl("txtPo")).Text;
                    Amount = Convert.ToDouble(decimal.Parse(((TextBox)GridView1.Controls[0].Controls[0].FindControl("txtAmt")).Text).ToString("N3"));
                    Particular = ((TextBox)GridView1.Controls[0].Controls[0].FindControl("txtparticul")).Text;

                    SqlDataSource2.InsertParameters["CompId"].DefaultValue = CompId.ToString();
                    SqlDataSource2.InsertParameters["SessionId"].DefaultValue = sId;
                    SqlDataSource2.InsertParameters["ProformaInvNo"].DefaultValue = ProformaInvNo;
                    SqlDataSource2.InsertParameters["InvDate"].DefaultValue = InvDate;
                    SqlDataSource2.InsertParameters["PONo"].DefaultValue = PONo;
                    SqlDataSource2.InsertParameters["Amount"].DefaultValue = Amount.ToString();
                    SqlDataSource2.InsertParameters["Particular"].DefaultValue = Particular;
                    SqlDataSource2.InsertParameters["Types"].DefaultValue = "1";
                    SqlDataSource2.Insert();

                }
            }
        }
        catch (Exception ex) { }
    }
    protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
    {

    }
    protected void GridView1_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {

        try
        {
            int index1 = GridView1.EditIndex;
            GridViewRow row = GridView1.Rows[index1];
            int id1 = Convert.ToInt32(GridView1.DataKeys[e.RowIndex].Value);
            string ProformaInvNo = "";
            string InvDate = "";
            string PONo = "";
            double Amount = 0;
            string Particular = "";
            if (((TextBox)row.FindControl("txtAmount")).Text != "" && ((TextBox)row.FindControl("txtAmount")).Text != "0" && fun.NumberValidationQty(((TextBox)row.FindControl("txtAmount")).Text) == true)
            {
                ProformaInvNo = ((TextBox)row.FindControl("txtProforInvNo")).Text;
                Amount = Convert.ToDouble(decimal.Parse(((TextBox)row.FindControl("txtAmount")).Text).ToString("N3"));
                InvDate = ((TextBox)row.FindControl("textDate")).Text;
                PONo = ((TextBox)row.FindControl("txtPoNo")).Text;
                Particular = ((TextBox)row.FindControl("txtParticulars")).Text;
                SqlDataSource2.UpdateParameters["CompId"].DefaultValue = CompId.ToString();
                SqlDataSource2.UpdateParameters["SessionId"].DefaultValue = sId;
                SqlDataSource2.UpdateParameters["ProformaInvNo"].DefaultValue = ProformaInvNo;
                SqlDataSource2.UpdateParameters["InvDate"].DefaultValue = InvDate;
                SqlDataSource2.UpdateParameters["PONo"].DefaultValue = PONo;
                SqlDataSource2.UpdateParameters["Amount"].DefaultValue = Amount.ToString();
                SqlDataSource2.UpdateParameters["Particular"].DefaultValue = Particular;
                SqlDataSource2.Update();

            }
        }
        catch (Exception ex)
        {
        }
        finally
        {
            con.Close();

        }
    }
    protected void GridView2_RowCommand(object sender, GridViewCommandEventArgs e)
    {

        try
        {

            double Amount = 0;
            string Particular = "";

            if (e.CommandName == "Add")
            {

                if (((TextBox)GridView2.FooterRow.FindControl("txtAmountFoot")).Text != "")
                {

                    Amount = Convert.ToDouble(decimal.Parse(((TextBox)GridView2.FooterRow.FindControl("txtAmountFoot")).Text).ToString("N3"));
                    Particular = ((TextBox)GridView2.FooterRow.FindControl("txtParticularsFoot")).Text;
                    string StrAddSal = fun.insert("tblACC_Advice_Payment_Temp", "Amount, Particular, CompId,SessionId,Types", "'" + Amount + "','" + Particular + "','" + CompId + "','" + sId + "','2'");
                    SqlCommand cmd11 = new SqlCommand(StrAddSal, con);
                    con.Open();
                    cmd11.ExecuteNonQuery();
                    con.Close();
                    this.FillGrid_Salary();
                }
            }
            if (e.CommandName == "Add1")
            {

                if (((TextBox)GridView2.Controls[0].Controls[0].FindControl("txtAmt")).Text != "")
                {

                    Amount = Convert.ToDouble(decimal.Parse(((TextBox)GridView2.Controls[0].Controls[0].FindControl("txtAmt")).Text).ToString("N3"));
                    Particular = ((TextBox)GridView2.Controls[0].Controls[0].FindControl("txtparticul")).Text;

                    string StrAddSal = fun.insert("tblACC_Advice_Payment_Temp", "Amount, Particular, CompId,SessionId,Types", "'" + Amount + "','" + Particular + "','" + CompId + "','" + sId + "','2'");
                    SqlCommand cmd11 = new SqlCommand(StrAddSal, con);
                    con.Open();
                    cmd11.ExecuteNonQuery();
                    con.Close();
                    this.FillGrid_Salary();

                }
            }
        }
        catch (Exception ex) { }

    }
    protected void GridView2_RowDataBound(object sender, GridViewRowEventArgs e)
    {

    }
    protected void GridView2_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {
        try
        {
            int index1 = GridView2.EditIndex;
            GridViewRow row = GridView2.Rows[index1];
            int id1 = Convert.ToInt32(GridView2.DataKeys[e.RowIndex].Value);
            double Amount = 0;
            string Particular = "";
            if (((TextBox)row.FindControl("txtAmount")).Text != "" && ((TextBox)row.FindControl("txtAmount")).Text != "0" && fun.NumberValidationQty(((TextBox)row.FindControl("txtAmount")).Text) == true)
            {
                Amount = Convert.ToDouble(decimal.Parse(((TextBox)row.FindControl("txtAmount")).Text).ToString("N3"));
                Particular = ((TextBox)row.FindControl("txtParticulars")).Text;
                string StrUpdateSal = fun.update("tblACC_Advice_Payment_Temp", "Amount='" + Amount + "', Particular='" + Particular + "',CompId='" + CompId + "',SessionId='" + sId + "'", "Id='" + id1 + "'");
                SqlCommand cmd11 = new SqlCommand(StrUpdateSal, con);
                con.Open();
                cmd11.ExecuteNonQuery();
                con.Close();
                GridView2.EditIndex = -1;
                this.FillGrid_Salary();
            }
        }
        catch (Exception ex)
        {
        }
        finally
        {
            con.Close();

        }
    }

    protected void btnProceed_Sal_Click(object sender, EventArgs e)
    {
        try
        {
            string connStr = fun.Connection();
            SqlConnection con = new SqlConnection(connStr);
            DataSet DS = new DataSet();
            CDate = fun.getCurrDate();
            CTime = fun.getCurrTime();
            string PayTo = fun.getCode(txtPayTo_Sal.Text);
            string cmdStr = fun.select("ADNo", "tblACC_Advice_Payment_Master", "CompId='" + CompId + "' AND FinYearId='" + FinYearId + "' order by Id desc");
            SqlCommand cmd1 = new SqlCommand(cmdStr, con);
            SqlDataAdapter da = new SqlDataAdapter(cmd1);
            da.Fill(DS, "tblACC_Advice_Payment_Master");
            string ADNo;
            if (DS.Tables[0].Rows.Count > 0)
            {
                int bvno = Convert.ToInt32(DS.Tables[0].Rows[0][0].ToString()) + 1;
                ADNo = bvno.ToString("D4");
            }
            else
            {
                ADNo = "0001";
            }
            int EmpSupId = fun.chkEmpCustSupplierCode(PayTo, 1, CompId);
            string sql5 = fun.select("*", "tblACC_Advice_Payment_Temp", "CompId='" + CompId + "' AND SessionId='" + sId + "' And Types='2'");
            SqlCommand cmd5 = new SqlCommand(sql5, con);
            SqlDataAdapter da5 = new SqlDataAdapter(cmd5);
            DataSet DS5 = new DataSet();
            da5.Fill(DS5);

            if (DS5.Tables[0].Rows.Count > 0)
            {

                if (EmpSupId == 1 && TxtChequeNo_Sal.Text != "" && TxtChequeDate_Sal.Text != "" && txtPayAt_Sal.Text != "" && txtPayTo_Sal.Text != "" && fun.DateValidation(TxtChequeDate_Sal.Text) == true)
                {
                    string StrBVPMaster = fun.insert("tblACC_Advice_Payment_Master", "SysDate,SysTime,SessionId,CompId,FinYearId,ADNo,Type,PayTo,ChequeNo,ChequeDate,PayAt,Bank,ECSType", "'" + CDate + "','" + CTime + "','" + sId + "','" + CompId + "','" + FinYearId + "','" + ADNo + "','2','" + PayTo + "','" + TxtChequeNo_Sal.Text + "','" + fun.FromDate(TxtChequeDate_Sal.Text) + "','" + txtPayAt_Sal.Text + "','" + DropDownList2.SelectedValue + "','1'");
                    SqlCommand cmd11 = new SqlCommand(StrBVPMaster, con);
                    con.Open();
                    cmd11.ExecuteNonQuery();
                    con.Close();

                    string sqlMId = fun.select("Id", "tblACC_Advice_Payment_Master", "CompId='" + CompId + "' AND ADNo='" + ADNo + "' Order By Id Desc");
                    SqlCommand cmdMId = new SqlCommand(sqlMId, con);
                    SqlDataAdapter DAMId = new SqlDataAdapter(cmdMId);
                    DataSet DSMId = new DataSet();
                    DAMId.Fill(DSMId);
                    string MId = DSMId.Tables[0].Rows[0]["Id"].ToString();

                    for (int p = 0; p < DS5.Tables[0].Rows.Count; p++)
                    {
                        string StrCVPDetails = fun.insert("tblACC_Advice_Payment_Details", "MId,Particular,Amount", "'" + MId + "','" + DS5.Tables[0].Rows[p]["Particular"].ToString() + "','" + Convert.ToDouble(decimal.Parse(DS5.Tables[0].Rows[p]["Amount"].ToString()).ToString("N2")) + "'");
                        SqlCommand cmd15 = new SqlCommand(StrCVPDetails, con);
                        con.Open();
                        cmd15.ExecuteNonQuery();
                        con.Close();
                    }
                    string delsql = fun.delete("tblACC_Advice_Payment_Temp", "CompId='" + CompId + "' AND SessionId='" + sId + "'And Types='2'");
                    SqlCommand cmd12 = new SqlCommand(delsql, con);
                    con.Open();
                    cmd12.ExecuteNonQuery();
                    con.Close();

                    Page.Response.Redirect(Page.Request.Url.ToString(), true);
                }
                else
                {
                    string myStringVariable = string.Empty;
                    myStringVariable = "Invalid data entry.";
                    ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
                }
            }
            else
            {
                string myStringVariable = string.Empty;
                myStringVariable = "Records are not found.";
                ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
            }

        }
        catch (Exception ex) { }


    }
    protected void GridView3_RowCommand(object sender, GridViewCommandEventArgs e)
    {

        try
        {

            double Amount = 0;
            string Particular = "";
            string withinGr = "";
            string WONO = "";
            int BGGroup = 1;
            if (e.CommandName == "Add")
            {

                int u = 0;
                if (((RadioButtonList)GridView3.FooterRow.FindControl("RadioButtonWONoGroupF")).SelectedValue == "0")
                {

                    if (fun.CheckValidWONo(((TextBox)GridView3.FooterRow.FindControl("txtWONoF")).Text, CompId, FinYearId) == true && ((TextBox)GridView3.FooterRow.FindControl("txtWONoF")).Text != "")
                    {
                        WONO = ((TextBox)GridView3.FooterRow.FindControl("txtWONoF")).Text;
                    }
                    else
                    {
                        u++;
                    }
                }
                else
                {

                    BGGroup = Convert.ToInt32(((DropDownList)GridView3.FooterRow.FindControl("drpGroupF")).SelectedValue);
                }

                if (((TextBox)GridView3.FooterRow.FindControl("txtAmountFoot")).Text != "" && ((TextBox)GridView3.FooterRow.FindControl("txtwithingrFt")).Text != "" && u == 0)
                {

                    Amount = Convert.ToDouble(decimal.Parse(((TextBox)GridView3.FooterRow.FindControl("txtAmountFoot")).Text).ToString("N3"));
                    withinGr = ((TextBox)GridView3.FooterRow.FindControl("txtwithingrFt")).Text;
                    Particular = ((TextBox)GridView3.FooterRow.FindControl("txtParticularsFoot")).Text;
                    string StrBVP_Temp = fun.insert("tblACC_Advice_Payment_Temp", "SessionId,CompId,Types,Amount,Particular,WONo,BG,WithinGroup", "'" + sId + "','" + CompId + "','3','" + Amount + "','" + Particular + "','" + WONO + "','" + BGGroup + "','" + withinGr + "'");
                    SqlCommand cmd11 = new SqlCommand(StrBVP_Temp, con);
                    con.Open();
                    cmd11.ExecuteNonQuery();
                    con.Close();
                    this.FillGrid_Other();
                }
                else
                {
                    string mystring = string.Empty;
                    mystring = "Invalid WONo.";
                    ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + mystring + "');", true);
                }
            }
            if (e.CommandName == "Add1")
            {
                int u = 0;
                if (((RadioButtonList)GridView3.Controls[0].Controls[0].FindControl("RadioButtonWONoGroup")).SelectedValue == "0")
                {
                    if (fun.CheckValidWONo(((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtWONo")).Text, CompId, FinYearId) == true && ((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtWONo")).Text != "")
                    {
                        WONO = ((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtWONo")).Text;
                    }
                    else
                    {
                        u++;
                    }

                }
                else
                {

                    BGGroup = Convert.ToInt32(((DropDownList)GridView3.Controls[0].Controls[0].FindControl("drpGroup")).SelectedValue);
                }
                if (((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtAmt")).Text != "" && ((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtwithinGr")).Text != "" && u == 0)
                {

                    Amount = Convert.ToDouble(decimal.Parse(((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtAmt")).Text).ToString("N3"));
                    Particular = ((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtparticul")).Text;
                    withinGr = ((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtwithinGr")).Text;
                    string StrBVP_Temp = fun.insert("tblACC_Advice_Payment_Temp", "SessionId,CompId,Types,Amount,Particular,WONo,BG,WithinGroup", "'" + sId + "','" + CompId + "','3','" + Amount + "','" + Particular + "','" + WONO + "','" + BGGroup + "','" + withinGr + "'");
                    SqlCommand cmd11 = new SqlCommand(StrBVP_Temp, con);
                    con.Open();
                    cmd11.ExecuteNonQuery();
                    con.Close();
                    this.FillGrid_Other();
                }
            }
        }
        catch (Exception ex) { }
    }
    protected void GridView3_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {

        try
        {
            int index1 = GridView3.EditIndex;
            GridViewRow row = GridView3.Rows[index1];
            int id1 = Convert.ToInt32(GridView3.DataKeys[e.RowIndex].Value);
            double Amount = 0;
            string Particular = "";
            string withinGr = "";
            string WONO = "";
            int BGGroup = 1;
            int u = 0;
            if (((RadioButtonList)row.FindControl("RadioButtonWONoGroupE")).SelectedValue == "0")
            {


                if (((TextBox)row.FindControl("txtWONoE")).Text != "")
                {
                    if (fun.CheckValidWONo(((TextBox)row.FindControl("txtWONoE")).Text, CompId, FinYearId) == true)
                    {
                        WONO = ((TextBox)row.FindControl("txtWONoE")).Text;
                    }
                    else
                    {
                        u++;

                    }

                }
                else
                {
                    u++;

                }

            }
            else
            {

                BGGroup = Convert.ToInt32(((DropDownList)row.FindControl("drpGroupE")).SelectedValue);
            }

            if (((TextBox)row.FindControl("txtAmount")).Text != "" && ((TextBox)row.FindControl("txtwithGr")).Text != "" && u == 0)
            {
                Amount = Convert.ToDouble(decimal.Parse(((TextBox)row.FindControl("txtAmount")).Text).ToString("N3"));
                Particular = ((TextBox)row.FindControl("txtParticulars")).Text;
                withinGr = ((TextBox)row.FindControl("txtwithGr")).Text;
                string UpdateCommand = "UPDATE [tblACC_Advice_Payment_Temp] SET [Amount] = '" + Amount + "', [Particular] = '" + Particular + "', [CompId] ='" + CompId + "', [SessionId] ='" + sId + "',[WONo]='" + WONO + "' ,[BG]='" + BGGroup + "',[WithinGroup]='" + withinGr + "' WHERE [Id] = '" + id1 + "'";
                SqlCommand cmd11 = new SqlCommand(UpdateCommand, con);
                con.Open();
                cmd11.ExecuteNonQuery();
                con.Close();
                GridView3.EditIndex = -1;
                this.FillGrid_Other();
            }
            else
            {
                string mystring = string.Empty;
                mystring = "Invalid Input.";
                ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + mystring + "');", true);
            }


        }
        catch (Exception ex)
        {
        }
        finally
        {
            con.Close();

        }
    }
    protected void RadioButtonWONoGroup_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (((RadioButtonList)GridView3.Controls[0].Controls[0].FindControl("RadioButtonWONoGroup")).SelectedValue == "0")
        {
            ((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtWONo")).Visible = true;
            ((DropDownList)GridView3.Controls[0].Controls[0].FindControl("drpGroup")).Visible = false;
        }
        else
        {
            ((TextBox)GridView3.Controls[0].Controls[0].FindControl("txtWONo")).Visible = false;
            ((DropDownList)GridView3.Controls[0].Controls[0].FindControl("drpGroup")).Visible = true;
        }

    }
    protected void btnProceed_Oth_Click(object sender, EventArgs e)
    {
        try
        {

            DataSet DS = new DataSet();
            CDate = fun.getCurrDate();
            CTime = fun.getCurrTime();
            string PayTo = fun.getCode(txtPayTo_Others.Text);
            string cmdStr = fun.select("ADNo", "tblACC_Advice_Payment_Master", "CompId='" + CompId + "' AND FinYearId='" + FinYearId + "' order by Id desc");
            SqlCommand cmd1 = new SqlCommand(cmdStr, con);
            SqlDataAdapter da = new SqlDataAdapter(cmd1);
            da.Fill(DS, "tblACC_BankVoucher_Payment_Master");
            string ADNo;
            if (DS.Tables[0].Rows.Count > 0)
            {
                int bvno = Convert.ToInt32(DS.Tables[0].Rows[0][0].ToString()) + 1;
                ADNo = bvno.ToString("D4");
            }
            else
            {
                ADNo = "0001";
            }
            int CodeType = Convert.ToInt32(drptypeOther.SelectedValue);
            int EmpSupId = fun.chkEmpCustSupplierCode(PayTo, CodeType, CompId);
            string sql5 = fun.select("*", "tblACC_Advice_Payment_Temp", "CompId='" + CompId + "' AND SessionId='" + sId + "' And Types='3'");
            SqlCommand cmd5 = new SqlCommand(sql5, con);
            SqlDataAdapter da5 = new SqlDataAdapter(cmd5);
            DataSet DS5 = new DataSet();
            da5.Fill(DS5);

            if (DS5.Tables[0].Rows.Count > 0)
            {

                if (EmpSupId == 1 && txtChqNo.Text != "" && txtChq_Date.Text != "" && txtpayAt_oth.Text != "" && txtPayTo_Others.Text != "" && fun.DateValidation(txtChq_Date.Text) == true && CodeType != 0)
                {
                    string StrBVPMaster = fun.insert("tblACC_Advice_Payment_Master", "SysDate,SysTime,SessionId,CompId,FinYearId,ADNo,Type,PayTo,ChequeNo,ChequeDate,PayAt,Bank,ECSType", "'" + CDate + "','" + CTime + "','" + sId + "','" + CompId + "','" + FinYearId + "','" + ADNo + "','3','" + PayTo + "','" + txtChqNo.Text + "','" + fun.FromDate(txtChq_Date.Text) + "','" + txtpayAt_oth.Text + "','" + DropDownList3.SelectedValue + "','" + CodeType + "'");
                    SqlCommand cmd11 = new SqlCommand(StrBVPMaster, con);
                    con.Open();
                    cmd11.ExecuteNonQuery();
                    con.Close();

                    string sqlMId = fun.select("Id", "tblACC_Advice_Payment_Master", "CompId='" + CompId + "' AND ADNo='" + ADNo + "' Order By Id Desc");
                    SqlCommand cmdMId = new SqlCommand(sqlMId, con);
                    SqlDataAdapter DAMId = new SqlDataAdapter(cmdMId);
                    DataSet DSMId = new DataSet();
                    DAMId.Fill(DSMId);
                    string MId = DSMId.Tables[0].Rows[0]["Id"].ToString();

                    for (int p = 0; p < DS5.Tables[0].Rows.Count; p++)
                    {
                        string StrCVPDetails = fun.insert("tblACC_Advice_Payment_Details", "MId,Particular,Amount,WONo,BG,WithinGroup", "'" + MId + "','" + DS5.Tables[0].Rows[p]["Particular"].ToString() + "','" + Convert.ToDouble(decimal.Parse(DS5.Tables[0].Rows[p]["Amount"].ToString()).ToString("N2")) + "','" + DS5.Tables[0].Rows[p]["WONo"].ToString() + "','" + Convert.ToInt32(DS5.Tables[0].Rows[p]["BG"].ToString()) + "','" + DS5.Tables[0].Rows[p]["WithinGroup"].ToString() + "'");
                        SqlCommand cmd15 = new SqlCommand(StrCVPDetails, con);
                        con.Open();
                        cmd15.ExecuteNonQuery();
                        con.Close();
                    }
                    string delsql = fun.delete("tblACC_Advice_Payment_Temp", "CompId='" + CompId + "' AND SessionId='" + sId + "'And Types='3'");
                    SqlCommand cmd12 = new SqlCommand(delsql, con);
                    con.Open();
                    cmd12.ExecuteNonQuery();
                    con.Close();
                    this.FillGrid_Other();
                    txtPayTo_Others.Text = string.Empty;
                    txtChqNo.Text = string.Empty;
                    txtpayAt_oth.Text = string.Empty;
                    txtChq_Date.Text = string.Empty;

                }
                else
                {
                    string myStringVariable = string.Empty;
                    myStringVariable = "Invalid data entry.";
                    ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
                }
            }
            else
            {
                string myStringVariable = string.Empty;
                myStringVariable = "Records are not found.";
                ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
            }

        }
        catch (Exception ex) { }


    }
    protected void RadioButtonWONoGroupF_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (((RadioButtonList)GridView3.FooterRow.FindControl("RadioButtonWONoGroupF")).SelectedValue == "0")
        {
            ((TextBox)GridView3.FooterRow.FindControl("txtWONoF")).Visible = true;
            ((DropDownList)GridView3.FooterRow.FindControl("drpGroupF")).Visible = false;
        }
        else
        {
            ((TextBox)GridView3.FooterRow.FindControl("txtWONoF")).Visible = false;
            ((DropDownList)GridView3.FooterRow.FindControl("drpGroupF")).Visible = true;
        }


    }
    protected void GridView3_RowEditing(object sender, GridViewEditEventArgs e)
    {
        try
        {
            GridView3.EditIndex = e.NewEditIndex;
            this.FillGrid_Other();
            int index = GridView3.EditIndex;
            GridViewRow grv = GridView3.Rows[index];
            int id = Convert.ToInt32(((Label)grv.FindControl("lblIdE")).Text);
            string sql5 = fun.select("BG,WONo", "tblACC_Advice_Payment_Temp", "Id='" + id + "'");
            SqlCommand cmd5 = new SqlCommand(sql5, con);
            SqlDataAdapter da5 = new SqlDataAdapter(cmd5);
            DataSet DS5 = new DataSet();
            da5.Fill(DS5);
            if (DS5.Tables[0].Rows.Count > 0)
            {
                if (DS5.Tables[0].Rows[0]["WONo"].ToString() != "" && DS5.Tables[0].Rows[0]["WONo"] != DBNull.Value)
                {
                    ((RadioButtonList)grv.FindControl("RadioButtonWONoGroupE")).SelectedValue = "0";

                    ((TextBox)grv.FindControl("txtWONoE")).Text = DS5.Tables[0].Rows[0]["WONo"].ToString();

                }
                else
                {
                    ((RadioButtonList)grv.FindControl("RadioButtonWONoGroupE")).SelectedValue = "1";
                    ((DropDownList)grv.FindControl("drpGroupE")).Visible = true;
                    ((TextBox)grv.FindControl("txtWONoE")).Visible = false;
                    ((DropDownList)grv.FindControl("drpGroupE")).SelectedValue = DS5.Tables[0].Rows[0]["BG"].ToString();

                }
            }
        }
        catch (Exception ex)
        { }

    }
    protected void RadioButtonWONoGroupE_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            RadioButtonList x = (RadioButtonList)sender;
            GridViewRow grv = (GridViewRow)x.NamingContainer;
            if (((RadioButtonList)grv.FindControl("RadioButtonWONoGroupE")).SelectedValue == "0")
            {
                ((TextBox)grv.FindControl("txtWONoE")).Visible = true;
                ((DropDownList)grv.FindControl("drpGroupE")).Visible = false;
            }
            else
            {
                ((TextBox)grv.FindControl("txtWONoE")).Visible = false;
                ((DropDownList)grv.FindControl("drpGroupE")).Visible = true;
            }
        }

        catch (Exception ex)
        { }

    }
    public void FillGrid_Other()
    {
        try
        {

            DataTable dt = new DataTable();
            string str = "SELECT [tblACC_Advice_Payment_Temp].Id,Amount,Particular, (Case When WONo!='' then WONo Else 'NA' END)As WONo, [BusinessGroup].Symbol As BG,WithinGroup FROM [tblACC_BankVoucher_Payment_Temp] Inner Join [BusinessGroup] on [tblACC_BankVoucher_Payment_Temp].BG=[BusinessGroup].Id And ([SessionId] ='" + sId + "') AND ([CompId] ='" + CompId + "') And ([Types]=3)";
            SqlCommand cmdCustWo = new SqlCommand(str, con);
            SqlDataAdapter daCustWo = new SqlDataAdapter(cmdCustWo);
            DataSet DSCustWo = new DataSet();
            daCustWo.Fill(DSCustWo);
            GridView3.DataSource = DSCustWo;
            GridView3.DataBind();
            foreach (GridViewRow grv in GridView3.Rows)
            {

                string wono1 = ((Label)grv.FindControl("lblWONo")).Text;
                string bg = ((Label)grv.FindControl("lblBG")).Text;
                if (wono1 != "NA" && bg != "NA")
                {

                    ((RadioButtonList)grv.FindControl("RadioButtonWONoGroup1")).SelectedValue = "0";

                }
                else if (wono1 == "NA")
                {
                    ((RadioButtonList)grv.FindControl("RadioButtonWONoGroup1")).SelectedValue = "1";

                }
            }

        }

        catch (Exception ex)
        { }


    }


    public void FillGrid_Salary()
    {
        try
        {

            DataTable dt = new DataTable();

            string str = "SELECT * FROM tblACC_Advice_Payment_Temp WHERE SessionId ='" + sId + "'AND CompId = '" + CompId + "' And Types=2";
            SqlCommand cmdCustWo = new SqlCommand(str, con);
            SqlDataAdapter daCustWo = new SqlDataAdapter(cmdCustWo);
            DataSet DSCustWo = new DataSet();
            daCustWo.Fill(DSCustWo);
            GridView2.DataSource = DSCustWo;
            GridView2.DataBind();

        }

        catch (Exception ex)
        { }


    }

    public void FillGrid_Creditors()
    {
        try
        {

            DataTable dt = new DataTable();
            string GetSupCode = fun.getCode(txtPayTo_Credit.Text);
            string str = "SELECT tblACC_BillBooking_Master.PVEVNo, tblACC_BillBooking_Master.BillNo,tblACC_BillBooking_Master.Id ,tblACC_BillBooking_Master.BillDate,tblMM_PO_Master.PONo, tblACC_BillBooking_Details.GQNId, tblACC_BillBooking_Details.GSNId FROM tblACC_BillBooking_Details INNER JOIN tblACC_BillBooking_Master ON tblACC_BillBooking_Details.MId =tblACC_BillBooking_Master.Id INNER JOIN tblMM_PO_Master ON tblACC_BillBooking_Master.POId = tblMM_PO_Master.Id And tblACC_BillBooking_Master.SupplierId='" + GetSupCode + "'";
            SqlCommand cmdCustWo = new SqlCommand(str, con);
            SqlDataAdapter daCustWo = new SqlDataAdapter(cmdCustWo);
            DataSet DSCustWo = new DataSet();
            daCustWo.Fill(DSCustWo);

            dt.Columns.Add(new System.Data.DataColumn("PVEVNo", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("BillNo", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("BillDate", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("PONo", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("Id", typeof(Int32)));
            dt.Columns.Add(new System.Data.DataColumn("ActAmt", typeof(double)));
            dt.Columns.Add(new System.Data.DataColumn("PaidAmt", typeof(double)));
            dt.Columns.Add(new System.Data.DataColumn("BalAmt", typeof(double)));
            DataRow dr;
            for (int i = 0; i < DSCustWo.Tables[0].Rows.Count; i++)
            {

                dr = dt.NewRow();

                dr[0] = DSCustWo.Tables[0].Rows[i]["PVEVNo"].ToString();
                double ActAmt = 0;
                if (Convert.ToInt32(DSCustWo.Tables[0].Rows[i]["GQNId"]) != 0)
                {
                    string StrGQNQty = "SELECT tblQc_MaterialQuality_Details.AcceptedQty FROM         tblQc_MaterialQuality_Details INNER JOIN tblQc_MaterialQuality_Master ON tblQc_MaterialQuality_Details.MId = tblQc_MaterialQuality_Master.Id And tblQc_MaterialQuality_Details.MId='" + Convert.ToInt32(DSCustWo.Tables[0].Rows[i]["GQNId"]) + "' ";
                    SqlCommand cmd = new SqlCommand(StrGQNQty, con);
                    SqlDataAdapter da = new SqlDataAdapter(cmd);
                    DataSet DS = new DataSet();
                    da.Fill(DS);

                    if (DS.Tables[0].Rows.Count > 0)
                    {
                        ActAmt = Convert.ToDouble(decimal.Parse(DS.Tables[0].Rows[0][0].ToString()).ToString("N3"));

                    }


                }

                if (Convert.ToInt32(DSCustWo.Tables[0].Rows[i]["GSNId"]) != 0)
                {
                    string StrGSNQty = "SELECT tblinv_MaterialServiceNote_Details.ReceivedQty FROM         tblinv_MaterialServiceNote_Details INNER JOIN tblinv_MaterialServiceNote_Master ON tblinv_MaterialServiceNote_Details.MId = tblinv_MaterialServiceNote_Master.Id And tblinv_MaterialServiceNote_Details.MId='" + Convert.ToInt32(DSCustWo.Tables[0].Rows[i]["GSNId"]) + "' ";
                    SqlCommand cmd = new SqlCommand(StrGSNQty, con);
                    SqlDataAdapter da = new SqlDataAdapter(cmd);
                    DataSet DS = new DataSet();
                    da.Fill(DS);
                    if (DS.Tables[0].Rows.Count > 0)
                    {
                        ActAmt = Convert.ToDouble(decimal.Parse(DS.Tables[0].Rows[0][0].ToString()).ToString("N3"));
                    }

                }

                dr[1] = DSCustWo.Tables[0].Rows[i]["BillNo"].ToString();
                dr[2] = fun.FromDateDMY(DSCustWo.Tables[0].Rows[i]["BillDate"].ToString());
                dr[5] = ActAmt;
                dr[3] = DSCustWo.Tables[0].Rows[i]["PONo"].ToString();
                dr[4] = DSCustWo.Tables[0].Rows[i]["Id"].ToString();

                string sqlAmt = fun.select("Sum(Amount)As Amt", "tblACC_BankVoucher_Payment_Creditor_Temp", "CompId='" + CompId + "' AND PVEVNO='" + DSCustWo.Tables[0].Rows[i]["Id"].ToString() + "'");
                SqlCommand cmd5 = new SqlCommand(sqlAmt, con);
                SqlDataAdapter dastk5 = new SqlDataAdapter(cmd5);
                DataSet dsstk5 = new DataSet();
                dastk5.Fill(dsstk5);
                if (dsstk5.Tables[0].Rows.Count > 0 && dsstk5.Tables[0].Rows[0]["Amt"] != DBNull.Value)
                {
                    dr[6] = Convert.ToDouble(decimal.Parse((dsstk5.Tables[0].Rows[0]["Amt"]).ToString()).ToString("N3"));

                }
                else
                {
                    dr[6] = 0;
                }

                double DtlsAmt = 0;
                string sqlAmt2 = " Select Sum(Amount)As Amt from tblACC_BankVoucher_Payment_Details inner join tblACC_BankVoucher_Payment_Master on tblACC_BankVoucher_Payment_Details.MId=tblACC_BankVoucher_Payment_Master.Id And CompId='" + CompId + "' AND tblACC_BankVoucher_Payment_Details.PVEVNO='" + DSCustWo.Tables[0].Rows[i]["Id"].ToString() + "' And tblACC_BankVoucher_Payment_Master.Type=4";
                SqlCommand cmd6 = new SqlCommand(sqlAmt2, con);
                SqlDataAdapter dastk6 = new SqlDataAdapter(cmd6);
                DataSet dsstk6 = new DataSet();
                dastk6.Fill(dsstk6);
                if (dsstk6.Tables[0].Rows.Count > 0 && dsstk6.Tables[0].Rows[0]["Amt"] != DBNull.Value)
                {
                    DtlsAmt = Convert.ToDouble(decimal.Parse((dsstk6.Tables[0].Rows[0]["Amt"]).ToString()).ToString("N3"));

                }

                dr[7] = (ActAmt - (Convert.ToDouble(dr[6]) + DtlsAmt));
                if ((ActAmt - (Convert.ToDouble(dr[6]) + DtlsAmt)) > 0)
                {
                    dt.Rows.Add(dr);
                    dt.AcceptChanges();
                }
            }

            GridView4.DataSource = dt;
            GridView4.DataBind();
            this.GetValidate();
        }

        catch (Exception ex)
        { }


    }

    public void FillGrid_Creditors_Temp()
    {
        try
        {

            DataTable dt = new DataTable();

            string str = fun.select("*", "tblACC_Advice_Payment_Creditor_Temp", "SessionId='" + sId + "' And CompId='" + CompId + "'");
            SqlCommand cmdCustWo = new SqlCommand(str, con);
            SqlDataAdapter daCustWo = new SqlDataAdapter(cmdCustWo);
            DataSet DSCustWo = new DataSet();
            daCustWo.Fill(DSCustWo);
            dt.Columns.Add(new System.Data.DataColumn("PVEVNo", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("Id", typeof(Int32)));
            dt.Columns.Add(new System.Data.DataColumn("BillAgainst", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("Amount", typeof(double)));
            dt.Columns.Add(new System.Data.DataColumn("ActAmt", typeof(double)));
            dt.Columns.Add(new System.Data.DataColumn("BalAmt", typeof(double)));
            DataRow dr;
            for (int i = 0; i < DSCustWo.Tables[0].Rows.Count; i++)
            {

                dr = dt.NewRow();
                double ActAmt = 0;
                double PaidAmt = 0;

                string str2 = "SELECT tblACC_BillBooking_Master.PVEVNo,tblACC_BillBooking_Details.GQNId, tblACC_BillBooking_Details.GSNId FROM tblACC_BillBooking_Master INNER JOIN tblACC_BillBooking_Details ON tblACC_BillBooking_Master.Id=tblACC_BillBooking_Details.MId And tblACC_BillBooking_Master.Id='" + DSCustWo.Tables[0].Rows[i]["PVEVNO"].ToString() + "'";
                SqlCommand cmd = new SqlCommand(str2, con);
                SqlDataAdapter da = new SqlDataAdapter(cmd);
                DataSet DS = new DataSet();
                da.Fill(DS);
                if (DS.Tables[0].Rows.Count > 0)
                {
                    dr[0] = DS.Tables[0].Rows[0]["PVEVNo"].ToString();


                    if (Convert.ToInt32(DS.Tables[0].Rows[0]["GQNId"]) != 0)
                    {
                        string StrGQNQty = "SELECT tblQc_MaterialQuality_Details.AcceptedQty FROM         tblQc_MaterialQuality_Details INNER JOIN tblQc_MaterialQuality_Master ON tblQc_MaterialQuality_Details.MId = tblQc_MaterialQuality_Master.Id And tblQc_MaterialQuality_Details.MId='" + Convert.ToInt32(DS.Tables[0].Rows[0]["GQNId"]) + "' ";
                        SqlCommand cmd1 = new SqlCommand(StrGQNQty, con);
                        SqlDataAdapter da1 = new SqlDataAdapter(cmd1);
                        DataSet DS1 = new DataSet();
                        da1.Fill(DS1);

                        if (DS1.Tables[0].Rows.Count > 0)
                        {
                            ActAmt = Convert.ToDouble(decimal.Parse(DS1.Tables[0].Rows[0][0].ToString()).ToString("N3"));

                        }


                    }

                    if (Convert.ToInt32(DS.Tables[0].Rows[0]["GSNId"]) != 0)
                    {
                        string StrGSNQty = "SELECT tblinv_MaterialServiceNote_Details.ReceivedQty FROM         tblinv_MaterialServiceNote_Details INNER JOIN tblinv_MaterialServiceNote_Master ON tblinv_MaterialServiceNote_Details.MId = tblinv_MaterialServiceNote_Master.Id And tblinv_MaterialServiceNote_Details.MId='" + Convert.ToInt32(DSCustWo.Tables[0].Rows[i]["GSNId"]) + "' ";
                        SqlCommand cmd1 = new SqlCommand(StrGSNQty, con);
                        SqlDataAdapter da1 = new SqlDataAdapter(cmd1);
                        DataSet DS1 = new DataSet();
                        da1.Fill(DS1);
                        if (DS1.Tables[0].Rows.Count > 0)
                        {
                            ActAmt = Convert.ToDouble(decimal.Parse(DS1.Tables[0].Rows[0][0].ToString()).ToString("N3"));
                        }
                    }

                    string sqlAmt = fun.select("Sum(Amount)As Amt", "tblACC_Advice_Payment_Creditor_Temp", "CompId='" + CompId + "' AND PVEVNO='" + DSCustWo.Tables[0].Rows[i]["PVEVNo"].ToString() + "'");
                    SqlCommand cmd5 = new SqlCommand(sqlAmt, con);
                    SqlDataAdapter dastk5 = new SqlDataAdapter(cmd5);
                    DataSet dsstk5 = new DataSet();
                    dastk5.Fill(dsstk5);
                    if (dsstk5.Tables[0].Rows.Count > 0 && dsstk5.Tables[0].Rows[0]["Amt"] != DBNull.Value)
                    {
                        PaidAmt = Convert.ToDouble(decimal.Parse((dsstk5.Tables[0].Rows[0]["Amt"]).ToString()).ToString("N3"));

                    }


                }

                double DtlsAmt = 0;
                string sqlAmt2 = " Select Sum(Amount)As Amt from tblACC_Advice_Payment_Details inner join tblACC_Advice_Payment_Master on tblACC_Advice_Payment_Details.MId=tblACC_Advice_Payment_Master.Id And CompId='" + CompId + "' AND tblACC_Advice_Payment_Details.PVEVNO='" + DSCustWo.Tables[0].Rows[i]["PVEVNO"].ToString() + "' And tblACC_Advice_Payment_Master.Type=4";
                SqlCommand cmd6 = new SqlCommand(sqlAmt2, con);
                SqlDataAdapter dastk6 = new SqlDataAdapter(cmd6);
                DataSet dsstk6 = new DataSet();
                dastk6.Fill(dsstk6);
                if (dsstk6.Tables[0].Rows.Count > 0 && dsstk6.Tables[0].Rows[0]["Amt"] != DBNull.Value)
                {
                    DtlsAmt = Convert.ToDouble(decimal.Parse((dsstk6.Tables[0].Rows[0]["Amt"]).ToString()).ToString("N3"));

                }
                dr[1] = DSCustWo.Tables[0].Rows[i]["Id"].ToString();
                dr[2] = DSCustWo.Tables[0].Rows[i]["BillAgainst"].ToString();
                dr[3] = Convert.ToDouble(DSCustWo.Tables[0].Rows[i]["Amount"].ToString());
                dr[4] = ActAmt;
                dr[5] = (ActAmt - (PaidAmt + DtlsAmt));
                dt.Rows.Add(dr);
                dt.AcceptChanges();
            }

            GridView5.DataSource = dt;
            GridView5.DataBind();
        }

        catch (Exception ex)
        { }

    }

    protected void GridView3_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {
        try
        {
            int id = Convert.ToInt32(GridView3.DataKeys[e.RowIndex].Value);
            SqlCommand cmd = new SqlCommand("DELETE FROM tblACC_Advice_Payment_Temp WHERE Id=" + id + " And CompId='" + CompId + "'", con);
            con.Open();
            cmd.ExecuteNonQuery();
            con.Close();
            this.FillGrid_Other();
        }
        catch (Exception er) { }
    }
    protected void GridView3_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
    {
        try
        {
            GridView3.EditIndex = -1;
            this.FillGrid_Other();
        }
        catch (Exception er) { }
    }
    protected void btnProceed_Creditor_Click(object sender, EventArgs e)
    {
        try
        {
            string connStr = fun.Connection();
            SqlConnection con = new SqlConnection(connStr);
            DataSet DS = new DataSet();
            CDate = fun.getCurrDate();
            CTime = fun.getCurrTime();
            string PayTo = fun.getCode(txtPayTo_Credit.Text);
            string cmdStr = fun.select("ADNo", "tblACC_Advice_Payment_Master", "CompId='" + CompId + "' AND FinYearId='" + FinYearId + "' order by Id desc");
            SqlCommand cmd1 = new SqlCommand(cmdStr, con);
            SqlDataAdapter da = new SqlDataAdapter(cmd1);
            da.Fill(DS, "tblACC_BankVoucher_Payment_Master");
            string ADNo;
            if (DS.Tables[0].Rows.Count > 0)
            {
                int bvno = Convert.ToInt32(DS.Tables[0].Rows[0][0].ToString()) + 1;
                ADNo = bvno.ToString("D4");
            }
            else
            {
                ADNo = "0001";
            }

            int EmpSupId = fun.chkEmpCustSupplierCode(PayTo, 3, CompId);
            string sql5 = fun.select("*", "tblACC_Advice_Payment_Creditor_Temp", "CompId='" + CompId + "' AND SessionId='" + sId + "'");
            SqlCommand cmd5 = new SqlCommand(sql5, con);
            SqlDataAdapter da5 = new SqlDataAdapter(cmd5);
            DataSet DS5 = new DataSet();
            da5.Fill(DS5);

            if (DS5.Tables[0].Rows.Count > 0)
            {

                if (EmpSupId == 1 && txtPayTo_Credit.Text != "" && txtChequeNo_Credit.Text != "" && txtPayAt_Credit.Text != "" && txtChequeDate_Credit.Text != "" && fun.DateValidation(txtChequeDate_Credit.Text) == true)
                {
                    string StrBVPMaster = fun.insert("tblACC_Advice_Payment_Master", "SysDate,SysTime,SessionId,CompId,FinYearId,ADNo,Type,PayTo,ChequeNo,ChequeDate,PayAt,Bank,ECSType", "'" + CDate + "','" + CTime + "','" + sId + "','" + CompId + "','" + FinYearId + "','" + ADNo + "','4','" + PayTo + "','" + txtChequeNo_Credit.Text + "','" + fun.FromDate(txtChequeDate_Credit.Text) + "','" + txtPayAt_Credit.Text + "','" + DropDownList4.SelectedValue + "','3'");
                    SqlCommand cmd11 = new SqlCommand(StrBVPMaster, con);
                    con.Open();
                    cmd11.ExecuteNonQuery();
                    con.Close();

                    string sqlMId = fun.select("Id", "tblACC_Advice_Payment_Master", "CompId='" + CompId + "' AND ADNo='" + ADNo + "' Order By Id Desc");
                    SqlCommand cmdMId = new SqlCommand(sqlMId, con);
                    SqlDataAdapter DAMId = new SqlDataAdapter(cmdMId);
                    DataSet DSMId = new DataSet();
                    DAMId.Fill(DSMId);
                    string MId = DSMId.Tables[0].Rows[0]["Id"].ToString();

                    for (int p = 0; p < DS5.Tables[0].Rows.Count; p++)
                    {
                        string StrCVPDetails = fun.insert("tblACC_Advice_Payment_Details", "MId ,PVEVNO ,BillAgainst,Amount", "'" + MId + "','" + DS5.Tables[0].Rows[p]["PVEVNO"].ToString() + "','" + DS5.Tables[0].Rows[p]["BillAgainst"].ToString() + "','" + Convert.ToDouble(decimal.Parse(DS5.Tables[0].Rows[p]["Amount"].ToString()).ToString("N3")) + "'");
                        SqlCommand cmd15 = new SqlCommand(StrCVPDetails, con);
                        con.Open();
                        cmd15.ExecuteNonQuery();
                        con.Close();
                    }
                    string delsql = fun.delete("tblACC_Advice_Payment_Creditor_Temp", "CompId='" + CompId + "' AND SessionId='" + sId + "'");
                    SqlCommand cmd12 = new SqlCommand(delsql, con);
                    con.Open();
                    cmd12.ExecuteNonQuery();
                    con.Close();
                    this.FillGrid_Creditors();
                    this.FillGrid_Creditors_Temp();
                    txtPayTo_Credit.Text = string.Empty;
                    txtChequeNo_Credit.Text = string.Empty;
                    txtPayAt_Credit.Text = string.Empty;
                    txtChequeDate_Credit.Text = string.Empty;


                }
                else
                {
                    string myStringVariable = string.Empty;
                    myStringVariable = "Invalid data entry.";
                    ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
                }
            }
            else
            {
                string myStringVariable = string.Empty;
                myStringVariable = "Records are not found.";
                ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
            }

        }
        catch (Exception ex) { }


    }
    protected void btnSearch_Click(object sender, EventArgs e)
    {
        try
        {
            this.FillGrid_Creditors();
            btnSearch.Visible = false;
            txtPayTo_Credit.Enabled = false;
            btnRefresh.Visible = true;
            Panel5.Visible = true;
            this.FillGrid_Creditors_Temp();
        }
        catch(Exception)
        {
        }
    }
    protected void btnRefresh_Click(object sender, EventArgs e)
    {
        this.FillGrid_Creditors();
        btnSearch.Visible = true;
        txtPayTo_Credit.Enabled = true;
        txtPayTo_Credit.Text = "";
        btnRefresh.Visible = false;
        Panel5.Visible = false;
    }
    [System.Web.Services.WebMethodAttribute(), System.Web.Script.Services.ScriptMethodAttribute()]
    public static string[] Sql(string prefixText, int count, string contextKey)
    {
        clsFunctions fun = new clsFunctions();
        string connStr = fun.Connection();
        DataSet ds = new DataSet();
        SqlConnection con = new SqlConnection(connStr);
        con.Open();
        int CompId = Convert.ToInt32(HttpContext.Current.Session["compid"]);
        string cmdStr2 = fun.select("SupplierId,SupplierName", "tblMM_Supplier_master", "CompId='" + CompId + "'");
        SqlDataAdapter da2 = new SqlDataAdapter(cmdStr2, con);
        da2.Fill(ds, "tblMM_Supplier_master");
        con.Close();
        string[] main = new string[0];
        for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
        {

            if (ds.Tables[0].Rows[i].ItemArray[1].ToString().ToLower().StartsWith(prefixText.ToLower()))
            {
                Array.Resize(ref main, main.Length + 1);
                main[main.Length - 1] = ds.Tables[0].Rows[i].ItemArray[1].ToString() + " [" + ds.Tables[0].Rows[i].ItemArray[0].ToString() + "]";
                //if (main.Length == 15)
                //    break;
            }

        }

        Array.Sort(main);
        return main;
    }


    [System.Web.Services.WebMethodAttribute(), System.Web.Script.Services.ScriptMethodAttribute()]
    public static string[] Sql2(string prefixText, int count, string contextKey)
    {
        clsFunctions fun = new clsFunctions();
        string connStr = fun.Connection();
        DataSet ds = new DataSet();
        SqlConnection con = new SqlConnection(connStr);
        con.Open();
        int CompId = Convert.ToInt32(HttpContext.Current.Session["compid"]);
        string cmdStr2 = fun.select("EmpId,EmployeeName", "tblHR_OfficeStaff", "CompId='" + CompId + "'");
        SqlDataAdapter da2 = new SqlDataAdapter(cmdStr2, con);
        da2.Fill(ds, "tblHR_OfficeStaff");
        con.Close();
        string[] main = new string[0];
        for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
        {

            if (ds.Tables[0].Rows[i].ItemArray[1].ToString().ToLower().StartsWith(prefixText.ToLower()))
            {
                Array.Resize(ref main, main.Length + 1);
                main[main.Length - 1] = ds.Tables[0].Rows[i].ItemArray[1].ToString() + " [" + ds.Tables[0].Rows[i].ItemArray[0].ToString() + "]";
                //if (main.Length == 15)
                //    break;
            }

        }

        Array.Sort(main);
        return main;
    }

    protected void GridView4_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        string connStr = fun.Connection();
        SqlConnection con = new SqlConnection(connStr);
        con.Open();

        try
        {
            if (e.CommandName == "AddToTemp")
            {


                int y = 0;
                int x = 0;
                int k = 0;
                foreach (GridViewRow grv in GridView4.Rows)
                {
                    if (((CheckBox)grv.FindControl("ck")).Checked == true)
                    {
                        x++;
                        if (((CheckBox)grv.FindControl("ck")).Checked == true && ((TextBox)grv.FindControl("txtBill_Against")).Text != "" && ((TextBox)grv.FindControl("txtAmount")).Text != "" && fun.NumberValidationQty(((TextBox)grv.FindControl("txtAmount")).Text) == true && Convert.ToDouble(((TextBox)grv.FindControl("txtAmount")).Text) != 0)
                        {
                            double Amount = Convert.ToDouble(decimal.Parse(((TextBox)grv.FindControl("txtAmount")).Text).ToString("N3"));
                            double BalAmt = Convert.ToDouble(decimal.Parse(((Label)grv.FindControl("lblBalAmt")).Text).ToString("N3"));


                            if (BalAmt >= Amount)
                            {
                                y++;
                            }

                        }
                    }
                }

                if (x == y && y > 0)
                {



                    foreach (GridViewRow grv in GridView4.Rows)
                    {
                        if (((CheckBox)grv.FindControl("ck")).Checked == true && ((TextBox)grv.FindControl("txtBill_Against")).Text != "" && ((TextBox)grv.FindControl("txtAmount")).Text != "" && fun.NumberValidationQty(((TextBox)grv.FindControl("txtAmount")).Text) == true)
                        {

                            double Amount = Convert.ToDouble(decimal.Parse(((TextBox)grv.FindControl("txtAmount")).Text).ToString("N3"));
                            double BalAmt = Convert.ToDouble(decimal.Parse(((Label)grv.FindControl("lblBalAmt")).Text).ToString("N3"));
                            string BillAgainst = ((TextBox)grv.FindControl("txtBill_Against")).Text;
                            int PVEVNo = Convert.ToInt32(((Label)grv.FindControl("lblId")).Text);
                            if (BalAmt >= Amount)
                            {

                                SqlCommand exeme2 = new SqlCommand(fun.insert("tblACC_Advice_Payment_Creditor_Temp", "CompId,SessionId,PVEVNO,BillAgainst,Amount", "'" + CompId + "','" + sId + "','" + PVEVNo + "','" + BillAgainst + "','" + Amount + "'"), con);
                                exeme2.ExecuteNonQuery();
                                k++;

                            }

                        }
                    }
                }

                else
                {
                    string myStringVariable = string.Empty;
                    myStringVariable = "Invalid input data.";
                    ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + myStringVariable + "');", true);
                }

                if (k > 0)
                {
                    this.FillGrid_Creditors();
                    this.FillGrid_Creditors_Temp();
                }

            }



        }
        catch (Exception ex) { }
        finally
        { con.Close(); }
    }

    protected void GridView5_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        GridView5.PageIndex = e.NewPageIndex;
        this.FillGrid_Creditors_Temp();
    }
    protected void GridView5_RowEditing(object sender, GridViewEditEventArgs e)
    {
        GridView5.EditIndex = e.NewEditIndex;
        this.FillGrid_Creditors_Temp();
    }
    protected void GridView5_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {
        try
        {
            int id = Convert.ToInt32(GridView5.DataKeys[e.RowIndex].Value);
            SqlCommand cmd = new SqlCommand("DELETE FROM tblACC_Advice_Payment_Creditor_Temp WHERE Id=" + id + " And CompId='" + CompId + "'", con);
            con.Open();
            cmd.ExecuteNonQuery();
            con.Close();
            this.FillGrid_Creditors_Temp();
        }
        catch (Exception er) { }
    }
    protected void GridView5_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
    {
        try
        {
            GridView5.EditIndex = -1;
            this.FillGrid_Creditors_Temp();
        }
        catch (Exception er) { }
    }


    [System.Web.Services.WebMethodAttribute(), System.Web.Script.Services.ScriptMethodAttribute()]
    public static string[] sql3(string prefixText, int count, string contextKey)
    {
        clsFunctions fun = new clsFunctions();
        string connStr = fun.Connection();
        DataSet ds = new DataSet();
        SqlConnection con = new SqlConnection(connStr);
        con.Open();
        int CompId = Convert.ToInt32(HttpContext.Current.Session["compid"]);
        int CodeType = Convert.ToInt32(HttpContext.Current.Session["codetype"]);

        switch (CodeType)
        {
            case 1:
                {
                    string cmdStr = fun.select("EmpId,EmployeeName", "tblHR_OfficeStaff", "CompId='" + CompId + "' Order By EmployeeName ASC");
                    SqlDataAdapter da = new SqlDataAdapter(cmdStr, con);
                    da.Fill(ds, "tblHR_OfficeStaff");
                }
                break;

            case 2:
                {
                    string cmdStr = fun.select("CustomerId,CustomerName", "SD_Cust_master", "CompId='" + CompId + "' Order By CustomerName ASC");
                    SqlDataAdapter da = new SqlDataAdapter(cmdStr, con);
                    da.Fill(ds, "SD_Cust_master");
                }
                break;

            case 3:
                {
                    string cmdStr = fun.select("SupplierId,SupplierName", "tblMM_Supplier_master", "CompId='" + CompId + "' Order By SupplierName ASC");
                    SqlDataAdapter da = new SqlDataAdapter(cmdStr, con);
                    da.Fill(ds, "tblMM_Supplier_master");
                }
                break;

        }

        con.Close();
        string[] main = new string[0];
        for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
        {
            if (ds.Tables[0].Rows[i].ItemArray[1].ToString().ToLower().StartsWith(prefixText.ToLower()))
            {
                Array.Resize(ref main, main.Length + 1);
                main[main.Length - 1] = ds.Tables[0].Rows[i].ItemArray[1].ToString() + " [" + ds.Tables[0].Rows[i].ItemArray[0].ToString() + "]";
                //if (main.Length == 15)
                //    break;
            }
        }
        Array.Sort(main);
        return main;
    }


    protected void drptype_SelectedIndexChanged1(object sender, EventArgs e)
    {
        Session["codetype"] = drptype.SelectedValue;
        TextBox1.Text = string.Empty;
    }
    protected void drptypeOther_SelectedIndexChanged(object sender, EventArgs e)
    {
        Session["codetype1"] = drptypeOther.SelectedValue;
        txtPayTo_Others.Text = string.Empty;
        TabContainer1.ActiveTabIndex = 0;
    }
    protected void GridView2_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {
        try
        {
            int id = Convert.ToInt32(GridView2.DataKeys[e.RowIndex].Value);
            SqlCommand cmd = new SqlCommand("DELETE FROM tblACC_Advice_Payment_Temp WHERE Id=" + id + " And CompId='" + CompId + "'", con);
            con.Open();
            cmd.ExecuteNonQuery();
            con.Close();
            this.FillGrid_Salary();
        }
        catch (Exception er) { }
    }
    protected void GridView2_RowEditing(object sender, GridViewEditEventArgs e)
    {
        GridView2.EditIndex = e.NewEditIndex;
        this.FillGrid_Salary();
    }
    protected void GridView2_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
    {
        try
        {
            GridView2.EditIndex = -1;
            this.FillGrid_Salary();
        }
        catch (Exception er) { }
    }
    protected void GridView2_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        GridView2.PageIndex = e.NewPageIndex;
        this.FillGrid_Salary();
    }
    protected void GridView3_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        GridView3.PageIndex = e.NewPageIndex;
        this.FillGrid_Other();
    }

    public void dropdownCompany(DropDownList dpdlCompany)
    {
        try
        {
            DataSet DS = new DataSet();
            string connStr = fun.Connection();
            SqlConnection con = new SqlConnection(connStr);
            string cmdStr = fun.select1("Id,Description", "tblACC_ReceiptAgainst");
            SqlCommand cmd = new SqlCommand(cmdStr, con);
            SqlDataAdapter DA = new SqlDataAdapter(cmd);
            DA.Fill(DS, "tblACC_ReceiptAgainst");
            dpdlCompany.DataSource = DS.Tables[0];
            dpdlCompany.DataTextField = "Description";
            dpdlCompany.DataValueField = "Id";
            dpdlCompany.DataBind();
            dpdlCompany.Items.Insert(0, "Select");
        }
        catch (Exception ex) { }

    }

    public void Loaddata()
    {
       try
        {

            DataTable dt = new DataTable();
            string StrSql = fun.select("*", "tblACC_Advice_Received_Masters", " FinYearId<='" + FinYearId + "'  And  CompId='" + CompId + "'");
            SqlCommand cmdSql = new SqlCommand(StrSql, con);
            SqlDataAdapter daSql = new SqlDataAdapter(cmdSql);
            DataSet DSSql = new DataSet();
            daSql.Fill(DSSql);
            dt.Columns.Add(new System.Data.DataColumn("Id", typeof(int)));
            dt.Columns.Add(new System.Data.DataColumn("FinYear", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("ADRNo", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("Types", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("ReceivedFrom", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("InvoiceNo", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("ChequeNo", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("ChequeDate", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("ChequeReceivedBy", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("BankName", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("BankAccNo", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("ChequeClearanceDate", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("Narration", typeof(string)));
            dt.Columns.Add(new System.Data.DataColumn("Amount", typeof(double)));

            DataRow dr;
            for (int i = 0; i < DSSql.Tables[0].Rows.Count; i++)
            {
                dr = dt.NewRow();
                if (DSSql.Tables[0].Rows.Count > 0)
                {

                    string sqlFin = fun.select("FinYear", "tblFinancial_master", "FinYearId='" + DSSql.Tables[0].Rows[i]["FinYearId"].ToString() + "'");
                    SqlCommand cmdFinYr = new SqlCommand(sqlFin, con);
                    SqlDataAdapter daFin = new SqlDataAdapter(cmdFinYr);
                    DataSet DSFin = new DataSet();
                    daFin.Fill(DSFin);
                    dr[0] = DSSql.Tables[0].Rows[i]["Id"].ToString();
                    if (DSFin.Tables[0].Rows.Count > 0)
                    {
                        dr[1] = DSFin.Tables[0].Rows[0]["FinYear"].ToString();
                    }
                    dr[2] = DSSql.Tables[0].Rows[i]["ADRNo"].ToString();

                    string Sqltyp = fun.select("Description", "tblACC_ReceiptAgainst", "Id='" + DSSql.Tables[0].Rows[i]["Types"].ToString() + "'");
                    SqlCommand cmdtyp = new SqlCommand(Sqltyp, con);
                    SqlDataAdapter datyp = new SqlDataAdapter(cmdtyp);
                    DataSet DStyp = new DataSet();
                    datyp.Fill(DStyp);
                    if (DStyp.Tables[0].Rows.Count > 0)
                    {
                        dr[3] = DStyp.Tables[0].Rows[0]["Description"].ToString();
                    }
                    dr[4] = DSSql.Tables[0].Rows[i]["ReceivedFrom"].ToString();
                    dr[5] = DSSql.Tables[0].Rows[i]["InvoiceNo"].ToString();
                    dr[6] = DSSql.Tables[0].Rows[i]["ChequeNo"].ToString();
                    dr[7] = fun.FromDateDMY(DSSql.Tables[0].Rows[i]["ChequeDate"].ToString());
                    dr[8] = fun.EmpCustSupplierNames(1, DSSql.Tables[0].Rows[i]["ChequeReceivedBy"].ToString(), CompId);
                    dr[9] = DSSql.Tables[0].Rows[i]["BankName"].ToString();
                    dr[10] = DSSql.Tables[0].Rows[i]["BankAccNo"].ToString();
                    dr[11] = fun.FromDateDMY(DSSql.Tables[0].Rows[i]["ChequeClearanceDate"].ToString());
                    dr[12] = (DSSql.Tables[0].Rows[i]["Narration"].ToString());
                    dr[13] = Convert.ToDouble(DSSql.Tables[0].Rows[i]["Amount"]);
                    dt.Rows.Add(dr);
                    dt.AcceptChanges();
                }
            }
            GridView6.DataSource = dt;
            GridView6.DataBind();
        }
        catch (Exception ex) { }

    }
    protected void TxtSubmit_Click(object sender, EventArgs e)
    {

        try
        {


            string Strpvevno = fun.select("ADRNo", "tblACC_Advice_Received_Masters", "CompId='" + CompId + "' AND FinYearId='" + FinYearId + "' order by ADRNo desc");

            SqlCommand cmdpvevno = new SqlCommand(Strpvevno, con);
            SqlDataAdapter DApvevno = new SqlDataAdapter(cmdpvevno);
            DataSet DSpvevno = new DataSet();
            DApvevno.Fill(DSpvevno, "tblACC_Advice_Received_Masters");
            string PVEVNo = "";

            if (DSpvevno.Tables[0].Rows.Count > 0)
            {
                PVEVNo = (Convert.ToInt32(DSpvevno.Tables[0].Rows[0]["ADRNo"]) + 1).ToString("D4");
            }
            else
            {
                PVEVNo = "0001";
            }
            string CDate = fun.getCurrDate();
            string CTime = fun.getCurrTime();
            string ReceivedBy = fun.getCode(TxtReceived.Text);

            int EmpSupId = fun.chkEmpCustSupplierCode(ReceivedBy, 1, CompId);


            con.Open();
          if (EmpSupId == 1 && fun.DateValidation(TxtChequeDate.Text) == true && fun.DateValidation(TxtClearanceDate.Text) == true && fun.NumberValidationQty(TxtAmount.Text) == true && DrpTypes.SelectedValue != "0")
            {
                string sqlbill = fun.insert("tblACC_Advice_Received_Masters", "SysDate,SysTime,SessionId,CompId,FinYearId, ADRNo, Types , ReceivedFrom  ,InvoiceNo , ChequeNo, ChequeDate, ChequeReceivedBy, BankName, BankAccNo , ChequeClearanceDate , Narration, Amount ", "'" + CDate + "','" + CTime + "','" + sId + "','" + CompId + "','" + FinYearId + "','" + PVEVNo + "','" + DrpTypes.SelectedValue + "','" + TxtFrom.Text + "','" + TxtInvoiceNo.Text + "','" + TxtChequeNo.Text + "','" + fun.FromDate(TxtChequeDate.Text) + "','" + ReceivedBy + "','" + TxtBank.Text + "','" + TxtBankAccNo.Text + "','" + fun.FromDate(TxtClearanceDate.Text) + "','" + TxtNarration.Text + "','" + Convert.ToDouble(decimal.Parse((TxtAmount.Text).ToString()).ToString("N2")) + "'");
                SqlCommand cmdbill = new SqlCommand(sqlbill, con);
                cmdbill.ExecuteNonQuery();
                con.Close();
                //Response.Write(sqlbill);
                TxtChequeDate.Text = string.Empty;
                TxtClearanceDate.Text = string.Empty;
                TxtAmount.Text = string.Empty;
                TxtNarration.Text = string.Empty;
                TxtBank.Text = string.Empty;
                TxtReceived.Text = string.Empty;
                TxtFrom.Text = string.Empty;
                TxtBankAccNo.Text = string.Empty;
                TxtInvoiceNo.Text = string.Empty;
                TxtChequeNo.Text = string.Empty;
                DrpTypes.SelectedIndex = 0;
                this.Loaddata();
            }
          else
          {

              string mystring = string.Empty;
              mystring = "Input data is invalid.";
              ClientScript.RegisterStartupScript(this.GetType(), "myalert", "alert('" + mystring + "');", true);

          }

        }

        catch (Exception ex)
        {

        }
    }
    protected void DrpTypes_SelectedIndexChanged(object sender, EventArgs e)
    {
        if (DrpTypes.SelectedValue == "5")
        {
            TxtInvoiceNo.Visible = false;

        }
        else
        {
            TxtInvoiceNo.Visible = true;
        }

    }
    protected void GridView6_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        if (e.CommandName == "Del")
        {
            try
            { 
                con.Open();
                GridViewRow row = (GridViewRow)(((LinkButton)e.CommandSource).NamingContainer);
                string Id = ((Label)row.FindControl("lblId")).Text;
                string Str = fun.delete("tblACC_Advice_Received_Masters", " Id='" + Id + "'");
                SqlCommand cmd = new SqlCommand(Str, con);
                cmd.ExecuteNonQuery();
                this.Loaddata();
                con.Close();
            }
            catch (Exception ex)
            {
            }
        }


    }
}
