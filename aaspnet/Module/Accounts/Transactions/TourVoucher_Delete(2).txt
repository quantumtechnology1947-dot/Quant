=== FILE: /Users/shiv/workspace/syncortext/NewERP/Module/Accounts/Transactions/TourVoucher_Delete.aspx.txt ===

﻿<%@ Page Language="C#" MasterPageFile="~/MasterPage.master" AutoEventWireup="true" CodeFile="TourVoucher_Delete.aspx.cs" Inherits="Module_Accounts_Transactions_TourVoucher_Delete" Title="ERP" Theme="Default" %>
<%@ Register assembly="AjaxControlToolkit" namespace="AjaxControlToolkit" tagprefix="cc1" %>
<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
<link href="../../../Css/StyleSheet.css" rel="stylesheet" type="text/css" />
    <link href="../../../Css/yui-datatable.css" rel="stylesheet" type="text/css" />
    <link href="../../../Css/styles.css" rel="stylesheet" type="text/css" />
    <script src="../../../Javascript/loadingNotifier.js" type="text/javascript"></script>
    <script src="../../../Javascript/PopUpMsg.js" type="text/javascript"></script>
    
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="cp3" Runat="Server">
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="cp1" Runat="Server">
</asp:Content>
<asp:Content ID="Content4" ContentPlaceHolderID="cp2" Runat="Server">
</asp:Content>
<asp:Content ID="Content5" ContentPlaceHolderID="MainContent" Runat="Server">
</asp:Content>
<asp:Content ID="Content6" ContentPlaceHolderID="ContentPlaceHolder2" Runat="Server">
</asp:Content>
<asp:Content ID="Content7" ContentPlaceHolderID="ContentPlaceHolder3" Runat="Server">
<table align="left" cellpadding="0" cellspacing="0" width="100%">
      <tr>
            <td align="left" height="21" style="background:url(../../../images/hdbg.JPG)" height="21" 
                class="fontcsswhite">
                <b>&nbsp;Tour Voucher Delete </b></td>
               
        </tr>
        
        
         <tr>
             <td align="left" height="25" valign="middle">
        
            &nbsp;
        
            <asp:DropDownList ID="DrpField" runat="server" 
                onselectedindexchanged="DrpField_SelectedIndexChanged" AutoPostBack="True" 
                CssClass="box3">                
                <asp:ListItem Value="Select">Select</asp:ListItem> 
                 <asp:ListItem Value="5">TV No </asp:ListItem>            
                <asp:ListItem Value="0">TI No </asp:ListItem>
                <asp:ListItem Value="1">Employee Name</asp:ListItem>  
                <asp:ListItem Value="2">WO No </asp:ListItem>           
                <asp:ListItem Value="3">BG Group </asp:ListItem>  
                <asp:ListItem Value="4">Project Name </asp:ListItem>  
                               
            </asp:DropDownList>
            &nbsp;<asp:TextBox ID="TxtMrs" runat="server" Width="150px" CssClass="box3"></asp:TextBox>
            &nbsp;<asp:TextBox ID="TxtEmpName" runat="server" Width="250px" CssClass="box3"></asp:TextBox>
                  &nbsp;<asp:DropDownList ID="drpGroup" runat="server" CssClass="box3"></asp:DropDownList>
       &nbsp;<cc1:AutoCompleteExtender ID="TxtEmpName_AutoCompleteExtender" runat="server" 
                                DelimiterCharacters="" Enabled="True" ServiceMethod="GetCompletionList" 
                                ServicePath="" TargetControlID="TxtEmpName" UseContextKey="True"
                                 CompletionInterval="100" CompletionSetCount="2" FirstRowSelected="True" MinimumPrefixLength="1" ShowOnlyCurrentWordInCompletionListItem="True" CompletionListItemCssClass="bg" CompletionListHighlightedItemCssClass="bgtext" CompletionListCssClass="almt">
                            </cc1:AutoCompleteExtender>
        
                  <asp:Button ID="Button1" runat="server" onclick="Button1_Click" Text="Search" 
                     CssClass="redbox" />  
            </td>   
        
        </tr>
        
        
        <tr>
            <td colspan="2">
    <asp:GridView ID="GridView2" runat="server" CssClass="yui-datatable-theme" 
                    AutoGenerateColumns="False" AllowPaging="True" Width="99%" DataKeyNames="Id" 
        onrowcommand="GridView2_RowCommand" 
                    onpageindexchanging="GridView2_PageIndexChanging" PageSize="20">
        <Columns>
            <asp:TemplateField HeaderText="SN" ItemStyle-HorizontalAlign="Center"><ItemTemplate> <%# Container.DataItemIndex + 1%> 
                        </ItemTemplate>
                                <ItemStyle HorizontalAlign="Right" Width="2%"></ItemStyle>
                        </asp:TemplateField>   
                        
             <asp:TemplateField >
            <ItemTemplate>
            <asp:LinkButton ID="LinkButton1" runat="server"  CommandName="Del"  Text="Delete"></asp:LinkButton>
            </ItemTemplate>
            <ItemStyle HorizontalAlign="Center" Width="4%" />
            </asp:TemplateField>       
                  
            
            <asp:TemplateField HeaderText="Fin Year">
            <ItemTemplate>
            <asp:Label ID="lblFinYear" runat="server" Text='<%# Eval("FinYear") %>'></asp:Label>
            </ItemTemplate>
            <ItemStyle HorizontalAlign="Center" Width="4%" />
            </asp:TemplateField>
            <asp:TemplateField Visible="False">
            <ItemTemplate>
            <asp:Label ID="lblId" runat="server" Text='<%# Eval("Id") %>'></asp:Label>
            </ItemTemplate>
                <ItemStyle Width="4%" />
            </asp:TemplateField>
            
              <asp:TemplateField Visible="False">
            <ItemTemplate>
            <asp:Label ID="lblTIMId" runat="server" Text='<%# Eval("TIMId") %>'></asp:Label>
            </ItemTemplate>
                <ItemStyle HorizontalAlign="Center" Width="4%" />
            </asp:TemplateField>           
            
            <asp:TemplateField  HeaderText="TV No">
            <ItemTemplate>
               <%-- <asp:LinkButton ID="LinkButton1" runat="server"  CommandName="Sel"  Text='<%# Eval("TVNo") %>'></asp:LinkButton> --%> 
                <asp:Label ID="lblTVNo" runat="server" Text='<%# Eval("TVNo") %>'></asp:Label>
                
                       
            </ItemTemplate>
             <ItemStyle HorizontalAlign="Center" Width="4%" />
            </asp:TemplateField>
            
            
             <asp:TemplateField  HeaderText="TI No">
            <ItemTemplate>
            <asp:Label ID="lblTINo" runat="server" Text='<%# Eval("TINo") %>'></asp:Label>
            </ItemTemplate>
                  <ItemStyle HorizontalAlign="Center" Width="4%" />
            </asp:TemplateField>
            
            <asp:TemplateField  HeaderText="Emp Name">
            <ItemTemplate>
            <asp:Label ID="lblEmpName" runat="server" Text='<%# Eval("EmpName") %>'></asp:Label>
            </ItemTemplate>
                <ItemStyle Width="15%" />
            </asp:TemplateField>
            
             <asp:TemplateField  HeaderText="WO No">
            <ItemTemplate>
            <asp:Label ID="lblWONo" runat="server" Text='<%# Eval("WONo") %>'></asp:Label>
            </ItemTemplate>
             <ItemStyle HorizontalAlign="Center" Width="4%" />
            </asp:TemplateField>
            
            <asp:TemplateField  HeaderText="BG Group">
            <ItemTemplate>
            <asp:Label ID="lblBGGroup" runat="server" Text='<%# Eval("BGGroup") %>'></asp:Label>
            </ItemTemplate>
                <ItemStyle HorizontalAlign="Center" Width="4%" />
            </asp:TemplateField>
            
             <asp:TemplateField  HeaderText="Project Name">
            <ItemTemplate>
            <asp:Label ID="lblProjectName" runat="server" Text='<%# Eval("ProjectName") %>'></asp:Label>
            </ItemTemplate>
            
                 <ItemStyle Width="10%" />
            
            </asp:TemplateField>
            
            
             <asp:TemplateField  HeaderText="Place of Tour">
            <ItemTemplate>
            <asp:Label ID="lblPlaceOfTour" runat="server" Text='<%# Eval("PlaceOfTour") %>'></asp:Label>
            </ItemTemplate>
                 <ItemStyle Width="15%" />
            </asp:TemplateField>
            
             <asp:TemplateField  HeaderText="Tour Start Date">
            <ItemTemplate>
            <asp:Label ID="lblTourStartDate" runat="server" Text='<%# Eval("TourStartDate") %>'></asp:Label>
            </ItemTemplate> <ItemStyle HorizontalAlign="Center" Width="6%" />
            </asp:TemplateField>
             <asp:TemplateField  HeaderText="Tour End Date">
            <ItemTemplate>
            <asp:Label ID="lblTourEndDate" runat="server" Text='<%# Eval("TourEndDate") %>'></asp:Label>
            </ItemTemplate> <ItemStyle HorizontalAlign="Center" Width="6%" />
            </asp:TemplateField>         

        </Columns>
         <EmptyDataTemplate>
                    <table width="100%" class="fontcss">
                    <tr>
                    <td align="center">
                    <asp:Label ID="Label1" runat="server"  Text="No data to display !" Font-Size="Larger" ForeColor="maroon">
                    </asp:Label>
                    </td>
                    </tr>
                    </table>
                    </EmptyDataTemplate>
        
        
        
    </asp:GridView>
            </td>
        </tr>
    </table>

</asp:Content>
<asp:Content ID="Content8" ContentPlaceHolderID="ContentPlaceHolder4" Runat="Server">
</asp:Content>



=== FILE: /Users/shiv/workspace/syncortext/NewERP/Module/Accounts/Transactions/TourVoucher_Delete.aspx.cs ===

﻿using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Data.SqlClient;

public partial class Module_Accounts_Transactions_TourVoucher_Delete : System.Web.UI.Page
{
    clsFunctions fun = new clsFunctions();

    int CompId = 0; 
    int FyId = 0;
    string co = "";
    string id = "";
  

    protected void Page_Load(object sender, EventArgs e)
    {
        try
        {
            FyId = Convert.ToInt32(Session["finyear"].ToString());
            CompId = Convert.ToInt32(Session["compid"]);
            if (!IsPostBack)
            {
                TxtMrs.Visible = false;
                drpGroup.Visible = false;
                this.binddata(co, id);
            }
        }
         catch (Exception ex) { }

    }
    public void binddata(string Search, string EmpId)
    {
        string connStr = fun.Connection();
        SqlConnection con = new SqlConnection(connStr);
        try
        {

            string x = "";
            string y = "";
            string z = "";
            if (DrpField.SelectedValue == "1")
            {
                if (TxtEmpName.Text != "")
                {
                    y = " AND EmpId='" + fun.getCode(TxtEmpName.Text) + "'";
                }
            }
            if (DrpField.SelectedValue == "Select")
            {
                TxtMrs.Visible = true;
                TxtEmpName.Visible = false;
            }

            if (DrpField.SelectedValue == "0")
            {
                if (TxtMrs.Text != "")
                {

                    x = " AND TINo='" + TxtMrs.Text + "'";
                }
            }
            if (DrpField.SelectedValue == "2")
            {
                if (TxtMrs.Text != "")
                {
                    x = " AND WONo='" + TxtMrs.Text + "'";
                }
            }
            if (DrpField.SelectedValue == "3")
            {               

                    x = " AND BGGroupId='" + drpGroup.SelectedValue + "'"; 
            }
            if (DrpField.SelectedValue == "4")
            {
                if (TxtMrs.Text != "")
                {

                    x = " AND ProjectName like '%" + TxtMrs.Text + "%'";
                }
            }

            if (DrpField.SelectedValue == "5")
            {
                if (TxtMrs.Text != "")
                {
                    z = " AND TVNo ='" + TxtMrs.Text + "'";
                }
            }


            DataTable dt = new DataTable();
            string sql = fun.select("*", "tblACC_TourVoucher_Master", "CompId='" + CompId + "' And FinYearId<='" + FyId + "'"+z+" Order by Id Desc ");

            SqlCommand cmd = new SqlCommand(sql, con);
            SqlDataAdapter da = new SqlDataAdapter(cmd);
            DataSet ds = new DataSet();
            da.Fill(ds);
            dt.Columns.Add(new System.Data.DataColumn("Id", typeof(int)));//0
            dt.Columns.Add(new System.Data.DataColumn("EmpId", typeof(string)));//1
            dt.Columns.Add(new System.Data.DataColumn("FinYear", typeof(string)));//2
            dt.Columns.Add(new System.Data.DataColumn("EmpName", typeof(string)));//3
            dt.Columns.Add(new System.Data.DataColumn("WONo", typeof(string)));//4
            dt.Columns.Add(new System.Data.DataColumn("BGgroup", typeof(string)));//5
            dt.Columns.Add(new System.Data.DataColumn("ProjectName", typeof(string)));//6
            dt.Columns.Add(new System.Data.DataColumn("PlaceOfTour", typeof(string)));//7
            dt.Columns.Add(new System.Data.DataColumn("TourStartDate", typeof(string)));//8
            dt.Columns.Add(new System.Data.DataColumn("TourEndDate", typeof(string)));//9
            dt.Columns.Add(new System.Data.DataColumn("TVNo", typeof(string)));//10
            dt.Columns.Add(new System.Data.DataColumn("TINo", typeof(string))); // 11         
            dt.Columns.Add(new System.Data.DataColumn("TIMId", typeof(int)));//12

            for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
            {
                DataRow dr;
                dr = dt.NewRow();

                if (ds.Tables[0].Rows.Count > 0)
                {
                    dr[0] = ds.Tables[0].Rows[i]["Id"].ToString();
                    dr[10] = ds.Tables[0].Rows[i]["TVNo"].ToString();
                    dr[12] = ds.Tables[0].Rows[i]["TIMId"].ToString();

                    string sql1 = fun.select("*", "tblACC_TourIntimation_Master", "Id='" + ds.Tables[0].Rows[i]["TIMId"].ToString() + "' AND CompId='" + CompId + "' And FinYearId<='" + FyId + "'" + y + x + " Order by Id Desc");

                    SqlCommand cmd1 = new SqlCommand(sql1, con);
                    SqlDataAdapter da1 = new SqlDataAdapter(cmd1);
                    DataSet ds1 = new DataSet();
                    da1.Fill(ds1);
                    if (ds1.Tables[0].Rows.Count > 0)
                    {                    

                        dr[1] = ds1.Tables[0].Rows[0]["EmpId"].ToString();
                        string sqlFin = fun.select("FinYear", "tblFinancial_master", "FinYearId='" + ds1.Tables[0].Rows[0]["FinyearId"] + "'");
                        SqlCommand cmdFinYr = new SqlCommand(sqlFin, con);
                        SqlDataAdapter daFin = new SqlDataAdapter(cmdFinYr);
                        DataSet DSFin = new DataSet();
                        daFin.Fill(DSFin);
                        if (DSFin.Tables[0].Rows.Count > 0)
                        {
                            dr[2] = DSFin.Tables[0].Rows[0]["FinYear"].ToString();
                        }


                        string cmdStr = fun.select("Title+'. '+EmployeeName+ ' ['+ EmpId +'] ' As EmpLoyeeName", "tblHR_OfficeStaff", "CompId='" + CompId + "'AND FinYearId<='" + FyId + "' AND EmpId='" + ds1.Tables[0].Rows[0]["EmpId"] + "'");
                        SqlDataAdapter daStr = new SqlDataAdapter(cmdStr, con);
                        DataSet DSStr = new DataSet();
                        daStr.Fill(DSStr, "tblHR_OfficeStaff");

                        dr[3] = DSStr.Tables[0].Rows[0]["EmployeeName"].ToString();

                        if (ds1.Tables[0].Rows[0]["BGGroupId"].ToString() != "1")
                        {
                            string sqlGrp = fun.select("Symbol AS BGgroup", "BusinessGroup", "Id='" + ds1.Tables[0].Rows[0]["BGGroupId"].ToString() + "'");
                            SqlCommand cmdGrp = new SqlCommand(sqlGrp, con);
                            SqlDataAdapter daGrp = new SqlDataAdapter(cmdGrp);
                            DataSet DSGrp = new DataSet();
                            daGrp.Fill(DSGrp);
                            if (DSGrp.Tables[0].Rows.Count > 0)
                            {
                                dr[5] = DSGrp.Tables[0].Rows[0]["BGgroup"].ToString();
                                dr[4] = "NA";
                            }

                        }
                        else
                        {
                            dr[5] = "NA";
                            dr[4] = ds1.Tables[0].Rows[0]["WONo"].ToString();
                        }

                        dr[6] = ds1.Tables[0].Rows[0]["ProjectName"].ToString();

                        //PlaceOfTour
                        string selectregCt = fun.select("CityName", "tblCity", "CityId='" + ds1.Tables[0].Rows[0]["PlaceOfTourCity"] + "'");
                        SqlCommand myCmdct = new SqlCommand(selectregCt, con);
                        SqlDataAdapter adct = new SqlDataAdapter(myCmdct);
                        DataSet Dsct = new DataSet();
                        adct.Fill(Dsct);

                        string selectregSt = fun.select("StateName", "tblState", "SId='" + ds1.Tables[0].Rows[0]["PlaceOfTourState"] + "' ");
                        SqlCommand myCmdst = new SqlCommand(selectregSt, con);
                        SqlDataAdapter adst = new SqlDataAdapter(myCmdst);
                        DataSet Dsst = new DataSet();
                        adst.Fill(Dsst);

                        string selectregCnt = fun.select("CountryName", "tblCountry", "CId='" + ds1.Tables[0].Rows[0]["PlaceOfTourCountry"] + "' ");
                        SqlCommand myCmdcnt = new SqlCommand(selectregCnt, con);
                        SqlDataAdapter adcnt = new SqlDataAdapter(myCmdcnt);
                        DataSet Dscnt = new DataSet();
                        adcnt.Fill(Dscnt);
                        string PlaceOfTour = "";

                        if (Dsct.Tables[0].Rows.Count > 0 && Dsst.Tables[0].Rows.Count > 0 && Dscnt.Tables[0].Rows.Count > 0)
                        {
                            PlaceOfTour = Dscnt.Tables[0].Rows[0]["CountryName"].ToString() + ", " + Dsst.Tables[0].Rows[0]["StateName"].ToString() + ", " + Dsct.Tables[0].Rows[0]["CityName"].ToString();
                        }
                        dr[7] = PlaceOfTour;
                        dr[8] = fun.FromDateDMY(ds1.Tables[0].Rows[0]["TourStartDate"].ToString());
                        dr[9] = fun.FromDateDMY(ds1.Tables[0].Rows[0]["TourEndDate"].ToString());
                        dr[11] = ds1.Tables[0].Rows[0]["TINo"].ToString();
                        dt.Rows.Add(dr);
                        dt.AcceptChanges();                        
                                        
                    }
                }
            }
            GridView2.DataSource = dt;
            GridView2.DataBind();



            con.Close();
        }
        catch (Exception ex) { }

    }
    protected void Button1_Click(object sender, EventArgs e)
    {
       try
        {
            string CustId = fun.getCode(TxtEmpName.Text);
            this.binddata(TxtMrs.Text, CustId);
        }
        catch (Exception ex){}

    }
    protected void DrpField_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            string connStr = fun.Connection();
            SqlConnection con = new SqlConnection(connStr);

            if (DrpField.SelectedValue == "Select")
            {
                drpGroup.Visible = false;
                TxtMrs.Visible = true;
                TxtMrs.Text = "";
                TxtEmpName.Visible = false;
                this.binddata(co, id);
            }
            if (DrpField.SelectedValue == "1")
            {
                drpGroup.Visible = false;
                TxtMrs.Visible = false;
                TxtEmpName.Visible = true;
                TxtEmpName.Text = "";
                this.binddata(co, id);
            }
            if (DrpField.SelectedValue == "0" || DrpField.SelectedValue == "2" || DrpField.SelectedValue == "4" ||DrpField.SelectedValue == "5")
            {
                drpGroup.Visible = false;
                TxtMrs.Visible = true;
                TxtMrs.Text = "";
                TxtEmpName.Visible = false;
                this.binddata(co, id);
            }

            if (DrpField.SelectedValue == "3")
            {
                TxtMrs.Visible = false;
                TxtMrs.Text = "";
                TxtEmpName.Visible = false;
                drpGroup.Visible = true;
                string cmdStrGroup = fun.select1("Symbol,Id ", " BusinessGroup");
                SqlCommand cmdGroup = new SqlCommand(cmdStrGroup, con);
                SqlDataAdapter DAGroup = new SqlDataAdapter(cmdGroup);
                DataSet DSGroup = new DataSet();
                DAGroup.Fill(DSGroup, "BusinessGroup");
                drpGroup.DataSource = DSGroup;
                drpGroup.DataTextField = "Symbol";
                drpGroup.DataValueField = "Id";
                drpGroup.DataBind();
                this.binddata(co, id);
            }
        }
        catch (Exception ex){}
    }

    [System.Web.Services.WebMethodAttribute(), System.Web.Script.Services.ScriptMethodAttribute()]
    public static string[] GetCompletionList(string prefixText, int count, string contextKey)
    {
        clsFunctions fun = new clsFunctions();
        string connStr = fun.Connection();
        DataSet ds = new DataSet();
        SqlConnection con = new SqlConnection(connStr);
        con.Open();
        int CompId = Convert.ToInt32(HttpContext.Current.Session["compid"]);
        string cmdStr = fun.select("EmpId,EmployeeName", "tblHR_OfficeStaff", "CompId='" + CompId + "'");
        SqlDataAdapter da = new SqlDataAdapter(cmdStr, con);
        da.Fill(ds, "tblHR_OfficeStaff");
        con.Close();
        string[] main = new string[0];
        for (int i = 0; i < ds.Tables[0].Rows.Count; i++)
        {
            if (ds.Tables[0].Rows[i].ItemArray[1].ToString().ToLower().StartsWith(prefixText.ToLower()))
            {
                Array.Resize(ref main, main.Length + 1);
                main[main.Length - 1] = ds.Tables[0].Rows[i].ItemArray[1].ToString() + " [" + ds.Tables[0].Rows[i].ItemArray[0].ToString() + "]";
                if (main.Length == 10)
                    break;
            }
        }
        Array.Sort(main);
        return main;
    }


    protected void GridView2_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        string connStr = fun.Connection();
        SqlConnection con = new SqlConnection(connStr);
        try
        {

            if (e.CommandName == "Del")
            {
                con.Open();
                GridViewRow grv = (GridViewRow)(((LinkButton)e.CommandSource).NamingContainer);
                int Id = Convert.ToInt32(((Label)grv.FindControl("lblId")).Text);

                //Tour Voucher Advance
                SqlCommand cmd = new SqlCommand(fun.delete("tblACC_TourVoucherAdvance", "MId='" + Id + "'"), con);
                cmd.ExecuteNonQuery();


                string sql11 = fun.select("*", "tblACC_TourVoucherAdvance", "MId='" + Id + "' ");
                SqlCommand cmd11 = new SqlCommand(sql11, con);
                SqlDataAdapter da11 = new SqlDataAdapter(cmd11);
                DataSet ds11 = new DataSet();
                da11.Fill(ds11);

                //Tour VoucherAdvance Details
                SqlCommand cmd2 = new SqlCommand(fun.delete("tblACC_TourVoucherAdvance_Details", "MId='" + Id + "'"), con);
                cmd2.ExecuteNonQuery();

                string sql = fun.select("*", "tblACC_TourVoucherAdvance_Details", "MId='" + Id + "' ");
                SqlCommand cmd3 = new SqlCommand(sql, con);
                SqlDataAdapter da = new SqlDataAdapter(cmd3);
                DataSet ds = new DataSet();
                da.Fill(ds);

                if (ds.Tables[0].Rows.Count == 0 && ds11.Tables[0].Rows.Count == 0)
                {
                    SqlCommand cmd4 = new SqlCommand(fun.delete("tblACC_TourVoucher_Master", "Id='" + Id + "'"), con);
                    cmd4.ExecuteNonQuery();
                    this.binddata(co, id);
                }
            }
        }
        catch (Exception es) { con.Close(); }
    }

    protected void GridView2_PageIndexChanging(object sender, GridViewPageEventArgs e)
    {
        GridView2.PageIndex = e.NewPageIndex;
        this.binddata(co, id);
    }
}
