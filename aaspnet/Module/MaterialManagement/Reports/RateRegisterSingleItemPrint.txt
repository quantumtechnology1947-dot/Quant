=== FILE: /Users/shiv/workspace/syncortext/NewERP/Module/MaterialManagement/Reports/RateRegisterSingleItemPrint.aspx.txt ===

﻿<%@ Page Language="C#" AutoEventWireup="true" CodeFile="RateRegisterSingleItemPrint.aspx.cs" Inherits="Module_MaterialManagement_Reports_RateRegisterSingleItemPrint" Theme="Default" %>

<%@ Register assembly="CrystalDecisions.Web, Version=10.5.3700.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" namespace="CrystalDecisions.Web" tagprefix="CR" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head id="Head1" runat="server">
    <link href="../../../Css/StyleSheet.css" rel="stylesheet" type="text/css" />
     <script src="../../../Javascript/loadingNotifier.js" type="text/javascript"></script>
    <title>ERP</title>
    </head>
<body style="margin-right:0; margin-left:0; margin-top:0; margin-bottom:0;">
<form id="Form1" runat="server">
<table align="left" cellpadding="0" cellspacing="0" width="100%">
        <tr>
            <td height="20" align="left" valign="middle"  scope="col" class="fontcsswhite" 
                style="background:url(../../../images/hdbg.JPG)">&nbsp;<b>Rate Register</b>
         </td>
        </tr>
       <td align="center">
         <asp:Panel ID="Panel1" runat="server" Height="430" ScrollBars="Auto" Width="100%" >
            <CR:CrystalReportViewer ID="CrystalReportViewer1" runat="server" 
                        AutoDataBind="true" EnableDatabaseLogonPrompt="False" 
                        EnableParameterPrompt="False" ReportSourceID="CrystalReportSource1" 
                        DisplayGroupTree="False" Width="350px" 
                ReuseParameterValuesOnRefresh="True" />
            <CR:CrystalReportSource ID="CrystalReportSource1" runat="server">
                <Report FileName="~\Module\MaterialManagement\Reports\RateRegSingleItem.rpt">
                </Report>
                
            </CR:CrystalReportSource>
        </asp:Panel>
      </td>
       </table>
</form>    
</body>
</html>


=== FILE: /Users/shiv/workspace/syncortext/NewERP/Module/MaterialManagement/Reports/RateRegisterSingleItemPrint.aspx.cs ===

﻿using System;
using System.Collections;
using System.Configuration;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Data.SqlClient;
using CrystalDecisions.CrystalReports.Engine;

public partial class Module_MaterialManagement_Reports_RateRegisterSingleItemPrint : System.Web.UI.Page
{
    int CompId = 0;
    int ItemId = 0; 
    clsFunctions fun = new clsFunctions();
    protected void Page_Load(object sender, EventArgs e)
    {
         try
        {
            CompId = Convert.ToInt32(Request.QueryString["CompId"].ToString());
            ItemId = Convert.ToInt32(Request.QueryString["ItemId"].ToString());
            DataSet xsdds = fun.RateRegister(ItemId, CompId);
            ReportDocument cryRpt = new ReportDocument();
            cryRpt = new ReportDocument();
            cryRpt.Load(Server.MapPath("~/Module/MaterialManagement/Reports/RateRegSingleItem.rpt"));
            cryRpt.SetDataSource(xsdds);
            // For Address
            string Address = fun.CompAdd(CompId);
            cryRpt.SetParameterValue("Address", Address);
            CrystalReportViewer1.ReportSource = cryRpt;            
        }
       catch (Exception ex){ }
    }

}